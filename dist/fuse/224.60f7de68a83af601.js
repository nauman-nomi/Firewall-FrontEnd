"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[224],{8125:(A,u,l)=>{l.d(u,{N:()=>U});var i=l(520);const e_apiUrl="http://192.168.0.107:443/api/";var g=l(5e3);let U=(()=>{class h{constructor(t){this.http=t,this.apiUrl=e_apiUrl+"/getNicInfo.php",this.updateApiUrl=e_apiUrl+"/updateNicInfo.php",this.updateGWApiUrl=e_apiUrl+"/updateDefaultGw.php",this.deleteSubNicApiUrl=e_apiUrl+"/deleteSubNic.php",this.addSubNicApiUrl=e_apiUrl+"/addSubNic.php",this.updateMacroApiUrl=e_apiUrl+"/updateMacros.php",this.updateFWOptionsApiUrl=e_apiUrl+"/updateFWOptions.php",this.getMacrosapiUrl=e_apiUrl+"/getMacros.php",this.apigetFWOptions=e_apiUrl+"/getFirewallOptions.php",this.getRoutingtableapiUrl=e_apiUrl+"/getRoutingTable.php",this.getQueueDefApiUrl=e_apiUrl+"masterApi.py/getQueueDefination",this.getMalwareListApiUrl=e_apiUrl+"maliciousIP.py/listMaliciousIP",this.updatetMalwareListApiUrl=e_apiUrl+"masterApi.py/updateMalwareFile",this.updateMalwareStatusApiUrl=e_apiUrl+"masterApi.py/UpdateMalwareIPStatus",this.getLogsApiUrl=e_apiUrl+"masterApi.py/logs",this.getDateTimeApiUrl=e_apiUrl+"dateTime.py",this.getUsageStatsApiUrl=e_apiUrl+"systemspec.py",this.getSystemInfoApiUrl=e_apiUrl+"sysinfo.py",this.getModSecApiUrl=e_apiUrl+"modSec.py/listDomain",this.deleteModSecApiUrl=e_apiUrl+"modSec.py/deleteDomain",this.getIPConfigApiUrl=e_apiUrl+"modSec.py/listip",this.addEmailGwApiUrl=e_apiUrl+"mailServer.py/addMailServer",this.getEmailGwApiUrl=e_apiUrl+"mailServer.py/viewMailServers",this.deleteEmailGwApiUrl=e_apiUrl+"mailServer.py/deleteMailServer",this.addMaliciousIPApiUrl=e_apiUrl+"/maliciousIP.py/addMaliciousIP",this.addCountryBlockApiUrl=e_apiUrl+"/countryBlock.py/add",this.addModSecApiUrl=e_apiUrl+"modSec.py/createDomain",this.deleteMaliciousIPApiUrl=e_apiUrl+"maliciousIP.py/deleteMaliciousIP",this.deleteCountryApiUrl=e_apiUrl+"countryBlock.py/delete",this.countryViewUrl=e_apiUrl+"countryBlock.py/view",this.countryAddUrl=e_apiUrl+"countryBlock.py/add",this.countryDeleteUrl=e_apiUrl+"countryBlock.py/delete",this.countryRunUrl=e_apiUrl+"countryBlock.py/run",this.listBlockIpUrl=e_apiUrl+"blockIP.py/listBlockIP",this.addBlockIpUrl=e_apiUrl+"blockIP.py/addBlockIP",this.deleteBlockIpUrl=e_apiUrl+"blockIP.py/deleteBlockIP",this.listWhitelistIpUrl=e_apiUrl+"whitelistIP.py/listWhitelistIP",this.addWhitelistIpUrl=e_apiUrl+"whitelistIP.py/addWhitelistIP",this.deleteWhitelistIpUrl=e_apiUrl+"whitelistIP.py/deleteWhitelistIP",this.listGeoBlockIpUrl=e_apiUrl+"geoBlockIP.py/listGeoBlockIP",this.addGeoBlockIpUrl=e_apiUrl+"geoBlockIP.py/addGeoBlockIP",this.deleteGeoBlockIpUrl=e_apiUrl+"geoBlockIP.py/deleteGeoBlockIP",this.apiKey="1234567890abcdef"}deleteMaliciousIP(t){console.log("deleteMaliciousIP() received:",t);const s=(new i.LE).set("ip_address",t);return console.log("Payload:",s.toString()),this.http.post(this.deleteMaliciousIPApiUrl,s.toString(),{headers:new i.WM({"Content-Type":"application/x-www-form-urlencoded"})})}unBlockCountry(t){const s=new i.WM({"Content-Type":"application/x-www-form-urlencoded"}),a=new i.LE({fromObject:t});return this.http.post(this.deleteCountryApiUrl,a.toString(),{headers:s})}UpdateMalwareData(){const t=new i.WM({"X-API-KEY":this.apiKey});return this.http.get(this.updatetMalwareListApiUrl,{headers:t})}updateMalwareIPStatus(t,s){const a=new i.WM({"X-API-KEY":this.apiKey,"Content-Type":"application/x-www-form-urlencoded"}),c=new URLSearchParams;return c.set("ip",t),c.set("status",s),this.http.post(this.updateMalwareStatusApiUrl,c.toString(),{headers:a})}getlogs(){const t=new i.WM({"X-API-KEY":this.apiKey});return this.http.get(this.getLogsApiUrl,{headers:t})}getMalwareListData(){const t=new i.WM({"X-API-KEY":this.apiKey});return this.http.get(this.getMalwareListApiUrl,{headers:t})}getNicData(){const t=new i.WM({"X-API-KEY":this.apiKey});return this.http.get(this.apiUrl,{headers:t})}getFWOPtionsData(){const t=new i.WM({"X-API-KEY":this.apiKey});return this.http.get(this.apigetFWOptions,{headers:t})}updateNicInfo(t){const s=new i.WM({"X-API-KEY":this.apiKey,"Content-Type":"application/json"});return this.http.post(this.updateApiUrl,t,{headers:s})}updateDefualtGW(t){const s=new i.WM({"X-API-KEY":this.apiKey,"Content-Type":"application/json"});return this.http.post(this.updateGWApiUrl,t,{headers:s})}deleteSubNic(t){const s=new i.WM({"X-API-KEY":this.apiKey,"Content-Type":"application/json"});return this.http.post(this.deleteSubNicApiUrl,t,{headers:s})}addSubNic(t){const s=new i.WM({"X-API-KEY":this.apiKey,"Content-Type":"application/json"});return this.http.post(this.addSubNicApiUrl,t,{headers:s})}updateMacros(t){const s=new i.WM({"X-API-KEY":this.apiKey,"Content-Type":"application/json"});return this.http.post(this.updateMacroApiUrl,t,{headers:s})}updateFWOptions(t){const s=new i.WM({"X-API-KEY":this.apiKey,"Content-Type":"application/json"});return this.http.post(this.updateFWOptionsApiUrl,t,{headers:s})}getRoutingData(){const t=new i.WM({"X-API-KEY":this.apiKey});return this.http.get(this.getRoutingtableapiUrl,{headers:t})}getMacrosList(){const t=new i.WM({"X-API-KEY":this.apiKey});return this.http.get(this.getMacrosapiUrl,{headers:t})}getQueueDefList(){const t=new i.WM({"X-API-KEY":this.apiKey});return this.http.get(this.getQueueDefApiUrl,{headers:t})}getDateTimeAPI(){return this.http.get(this.getDateTimeApiUrl)}getUsageStatsAPI(){return this.http.get(this.getUsageStatsApiUrl)}getSystemInfoAPI(){return this.http.get(this.getSystemInfoApiUrl)}getModSecListAPI(){return this.http.get(this.getModSecApiUrl)}deleteModSecApi(t){const s=new i.WM({"Content-Type":"application/x-www-form-urlencoded"}),a=new i.LE({fromObject:t});return this.http.post(this.deleteModSecApiUrl,a.toString(),{headers:s})}addEmailGw(t){return this.http.post(this.addEmailGwApiUrl,t)}addMaliciousIP(t){return this.http.post(this.addMaliciousIPApiUrl,t)}addCountryBlock(t){return this.http.post(this.addCountryBlockApiUrl,t)}getEmailGwListAPI(){return this.http.get(this.getEmailGwApiUrl)}deleteEmailGwApi(t){const s=new i.WM({"Content-Type":"application/x-www-form-urlencoded"}),a=new i.LE({fromObject:t});return this.http.post(this.deleteEmailGwApiUrl,a.toString(),{headers:s})}getIPConfigListAPI(){return this.http.get(this.getIPConfigApiUrl)}addModSecAPI(t){return this.http.post(this.addModSecApiUrl,t)}viewBlockedCountries(){return this.http.get(this.countryViewUrl)}addBlockedCountry(t){const s=new i.WM({"Content-Type":"application/x-www-form-urlencoded"}),a=(new i.LE).set("countries",t);return this.http.post(this.countryAddUrl,a.toString(),{headers:s})}deleteBlockedCountry(t){const s=new i.WM({"Content-Type":"application/x-www-form-urlencoded"}),a=(new i.LE).set("countries",t);return this.http.post(this.countryDeleteUrl,a.toString(),{headers:s})}execCountryCode(){const t=new i.WM({"Content-Type":"application/x-www-form-urlencoded"});return this.http.post(this.countryRunUrl,"",{headers:t})}getBlockIpListData(){const t=new i.WM({"X-API-KEY":this.apiKey});return this.http.get(this.listBlockIpUrl,{headers:t})}getWhitelistIpListData(){const t=new i.WM({"X-API-KEY":this.apiKey});return this.http.get(this.listWhitelistIpUrl,{headers:t})}getGeoBlockIpListData(){const t=new i.WM({"X-API-KEY":this.apiKey});return this.http.get(this.listGeoBlockIpUrl,{headers:t})}addBlockIP(t){return this.http.post(this.addBlockIpUrl,t)}addWhitelistIP(t){return this.http.post(this.addWhitelistIpUrl,t)}addGeoBlockIP(t){return this.http.post(this.addGeoBlockIpUrl,t)}deleteBlockIP(t){console.log("deleteBlockIP() received:",t);const s=(new i.LE).set("ip_address",t);return console.log("Payload:",s.toString()),this.http.post(this.deleteBlockIpUrl,s.toString(),{headers:new i.WM({"Content-Type":"application/x-www-form-urlencoded"})})}deleteWhitelistIP(t){console.log("deleteWhitelistIP() received:",t);const s=(new i.LE).set("ip_address",t);return console.log("Payload:",s.toString()),this.http.post(this.deleteWhitelistIpUrl,s.toString(),{headers:new i.WM({"Content-Type":"application/x-www-form-urlencoded"})})}deleteGeoBlockIP(t){console.log("deleteGeoBlockIP() received:",t);const s=(new i.LE).set("ip_address",t);return console.log("Payload:",s.toString()),this.http.post(this.deleteGeoBlockIpUrl,s.toString(),{headers:new i.WM({"Content-Type":"application/x-www-form-urlencoded"})})}}return h.\u0275fac=function(t){return new(t||h)(g.LFG(i.eN))},h.\u0275prov=g.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()},2224:(A,u,l)=>{l.r(u),l.d(u,{AllLogsModule:()=>W});var i=l(325),e=l(1377),g=l(1279),U=l(4466),h=l(8558),y=l(7775),t=l(1101),s=l(2916),a=l(353),c=l(4241);function w(r){const{subscriber:n,counter:o,period:d}=r;n.next(o),this.schedule({subscriber:n,counter:o+1,period:d},d)}var m=l(1086),P=l(7221),p=l(5e3),f=l(8125),M=l(9808);function S(r,n){if(1&r&&(p.TgZ(0,"div"),p._uU(1),p.qZA()),2&r){const o=n.$implicit;p.xp6(1),p.Oqu(o)}}const v=[{path:"",component:(()=>{class r{constructor(o){this.apiService=o,this.logs=[],this.alert={type:"success",message:""},this.showAlert=!1,this.loading=!1}ngOnInit(){this.fetchLogs(),this.subscription=function I(r=0,n=a.P){return(!(0,c.k)(r)||r<0)&&(r=0),(!n||"function"!=typeof n.schedule)&&(n=a.P),new s.y(o=>(o.add(n.schedule(w,r,{subscriber:o,counter:0,period:r})),o))}(3e3).subscribe(()=>this.fetchLogs())}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}showTimedAlert(o,d){this.alert.type=o,this.alert.message=d,this.showAlert=!0,setTimeout(()=>{this.showAlert=!1},2e3)}fetchLogs(){this.apiService.getlogs().pipe((0,P.K)(o=>(this.showTimedAlert("error","Error Fetching Data"),this.loading=!1,(0,m.of)({api_status:"error",message:"Failed to fetch data"})))).subscribe(o=>{this.showAlert=!1,"success"===o.api_status?(this.loading=!1,this.logs=o.logs||[],this.showTimedAlert("success","Logs Retrive Successfully")):(this.showTimedAlert("error",o.message||"Unknown error"),this.loading=!1)})}}return r.\u0275fac=function(o){return new(o||r)(p.Y36(f.N))},r.\u0275cmp=p.Xpm({type:r,selectors:[["app-all-logs"]],decls:4,vars:1,consts:[[1,"bg-gray-900","text-green-400","p-4","rounded-lg","h-96","overflow-y-auto","font-mono","text-sm"],[4,"ngFor","ngForOf"]],template:function(o,d){1&o&&(p.TgZ(0,"div"),p._uU(1," Auth Logs Live\n"),p.qZA(),p.TgZ(2,"div",0),p.YNc(3,S,2,1,"div",1),p.qZA()),2&o&&(p.xp6(3),p.Q6J("ngForOf",d.logs))},directives:[M.sg],styles:[""]}),r})()}];let W=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=p.oAB({type:r}),r.\u0275inj=p.cJS({imports:[[i.Bz.forChild(v),e.ot,g.Ps,h.rP,y.fC,t.Cv,U.m]]}),r})()}}]);