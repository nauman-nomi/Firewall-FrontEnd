"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[880],{4880:(_,u,i)=>{i.r(u),i.d(u,{MalwareModule:()=>W});var I=i(325),p=i(1377),n=i(1279),A=i(4466),M=i(1086),y=i(7221),T=i(9971),r=i(3075),d=i(8341),e=i(5e3),g=i(8125),f=i(9808),h=i(2494),c=i(1223),w=i(6766),b=i(6808);function C(s,l){if(1&s){const t=e.EpF();e.TgZ(0,"fuse-alert",16),e.NdJ("dismissed",function(){return e.CHM(t),e.oxw().showAlert=!1}),e._uU(1),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("type",t.alert.type)("dismissible",!0),e.xp6(1),e.hij(" ",t.alert.message," ")}}function Z(s,l){1&s&&(e.TgZ(0,"small",17),e._uU(1," Invalid IP Address. "),e.qZA())}function J(s,l){1&s&&e._UZ(0,"mat-progress-spinner",18),2&s&&e.Q6J("diameter",24)("mode","indeterminate")}let P=(()=>{class s{constructor(t,a,o,m,B){this.dialogRef=t,this.data=a,this.nicService=o,this.cdr=m,this.fb=B,this.errorAlert={type:"error",message:""},this.alert={type:"error",message:"Error!"},this.showAlert=!1,this.isSubmitting=!1,console.log(this.data.row),this.addMaliciousIPForm=this.fb.group({ip_address:["",[r.kI.required,r.kI.pattern(/^(\d{1,3}\.){3}\d{1,3}$/)]]})}ngOnInit(){}closeDialog(){this.dialogRef.close("Dialog Closed")}onSubmit(){if(this.addMaliciousIPForm.invalid)return this.showAlert=!0,this.errorAlert.message="Please fill all required fields correctly.",void(this.errorAlert.type="error");this.isSubmitting=!0;const t=this.addMaliciousIPForm.value,a=new FormData;a.append("ip_address",t.ip_address),this.nicService.addMaliciousIP(a).subscribe(o=>{this.isSubmitting=!1,this.showAlert=!0,this.alert.type="success",this.alert.message="IP Added successfully!",this.cdr.detectChanges(),setTimeout(()=>{this.dialogRef.close(a)},2e3)},o=>{this.isSubmitting=!1,this.showAlert=!0,this.alert.type="error",this.alert.message="Failed to add IP address. Please try again.",console.error("Error:",o),this.cdr.detectChanges()})}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(d.so),e.Y36(d.WI),e.Y36(g.N),e.Y36(e.sBO),e.Y36(r.qu))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-add-malware-ip"]],decls:21,vars:7,consts:[[1,"dialog-content"],[1,"dialog-header","bg-primary","rounded-t-2xl","p-2","px-4","flex","justify-between","items-center"],[1,"text-xl","font-semibold","leading-none","tracking-tight","text-white"],["mat-icon-button","",3,"click"],[1,"text-white"],[3,"type","dismissible","dismissed",4,"ngIf"],[1,"rounded-lg",3,"formGroup","ngSubmit"],[1,"dialog-body"],[1,"flex","justify-center","px-3"],["appearance","standard",1,"w-full"],[1,"block","font-semibold","mb-1"],["matInput","","type","text","formControlName","ip_address","placeholder","x.x.x.x"],["class","error",4,"ngIf"],["align","end",1,"mt-2"],["type","submit","mat-flat-button","",1,"fuse-mat-button-medium","w-28",3,"color","disabled"],["class","ml-3",3,"diameter","mode",4,"ngIf"],[3,"type","dismissible","dismissed"],[1,"error"],[1,"ml-3",3,"diameter","mode"]],template:function(t,a){if(1&t&&(e.TgZ(0,"mat-dialog-content",0)(1,"div",1)(2,"div",2),e._uU(3),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return a.closeDialog()}),e.TgZ(5,"mat-icon",4),e._uU(6,"close"),e.qZA()()(),e.YNc(7,C,2,3,"fuse-alert",5),e.TgZ(8,"form",6),e.NdJ("ngSubmit",function(){return a.onSubmit()}),e.TgZ(9,"div",7)(10,"div",8)(11,"mat-form-field",9)(12,"mat-label",10),e._uU(13,"Enter IP Address"),e.qZA(),e._UZ(14,"input",11),e.YNc(15,Z,2,0,"small",12),e.qZA()()(),e.TgZ(16,"div",13)(17,"button",14)(18,"span"),e._uU(19," Update "),e.qZA(),e.YNc(20,J,1,2,"mat-progress-spinner",15),e.qZA()()()()),2&t){let o;e.xp6(3),e.hij(" ",a.data.title," "),e.xp6(4),e.Q6J("ngIf",a.showAlert),e.xp6(1),e.Q6J("formGroup",a.addMaliciousIPForm),e.xp6(7),e.Q6J("ngIf",(null==(o=a.addMaliciousIPForm.get("ip_address"))?null:o.invalid)&&(null==(o=a.addMaliciousIPForm.get("ip_address"))?null:o.touched)),e.xp6(2),e.Q6J("color","primary")("disabled",a.addMaliciousIPForm.invalid||a.addMaliciousIPForm.hasError("nonUniqueSelection")),e.xp6(3),e.Q6J("ngIf",a.isSubmitting)}},directives:[d.xY,p.lW,n.Hw,f.O5,h.W,r._Y,r.JL,r.sg,c.KE,c.hX,w.Nt,r.Fj,r.JJ,r.u,b.Ou],styles:[""]}),s})();var x=i(1101),v=i(9824),F=i(1218);function N(s,l){if(1&s&&(e.TgZ(0,"fuse-alert",16),e._uU(1),e.qZA()),2&s){const t=e.oxw(2);e.Q6J("appearance","outline")("showIcon",!0)("type",t.alert.type),e.xp6(1),e.hij(" ",t.alert.message," ")}}function U(s,l){if(1&s&&(e.TgZ(0,"div",14),e.YNc(1,N,2,4,"fuse-alert",15),e.qZA()),2&s){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.showAlert)}}function S(s,l){1&s&&(e.TgZ(0,"div",17),e._UZ(1,"mat-progress-bar",18),e.qZA())}function Y(s,l){if(1&s){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){return e.CHM(t),e.oxw().AddMaliciousIP()}),e.TgZ(1,"mat-icon",20),e._uU(2,"add"),e.qZA()()}if(2&s){const t=e.oxw();e.Q6J("disabled",t.loading)}}function Q(s,l){if(1&s){const t=e.EpF();e.TgZ(0,"button",21),e.NdJ("click",function(){return e.CHM(t),e.oxw().refreshTable()}),e.TgZ(1,"mat-icon",20),e._uU(2,"refresh"),e.qZA()()}if(2&s){const t=e.oxw();e.Q6J("disabled",t.loading)}}let R=(()=>{class s{constructor(t,a,o){this.apiService=t,this.cdr=a,this.dialog=o,this.alert={type:"success",message:""},this.showAlert=!1,this.loading=!1,this.headerMapping={ip:"IP",malware_status:"Status",malware_action:"Action"},this.displayedColumns=["ip","malware_status","malware_action"],this.blockedIps=[],this.getMaliciousFileList()}showTimedAlert(t,a){this.alert.type=t,this.alert.message=a,this.showAlert=!0,setTimeout(()=>{this.showAlert=!1},2e3)}getMaliciousFileList(){this.loading=!0,this.apiService.getMalwareListData().pipe((0,y.K)(t=>(this.showTimedAlert("error","Error Fetching Data"),this.loading=!1,(0,M.of)({api_status:"error",message:"Failed to fetch data"})))).subscribe(t=>{if(this.showAlert=!1,"success"===t.api_status){this.loading=!1;const a=t.data;a.data=a.data.map(o=>({ip:o})),this.blockedIps=a.data,this.showTimedAlert("success","Updated Successfully")}else this.showTimedAlert("error",t.message||"Unknown error"),this.loading=!1}),this.loading=!1}onEditRow(t){"malware-ip-delete"===t.sep&&this.dialog.open(T.d,{width:"700px",disableClose:!0,data:{title:"Delete Malicious",row:t,message:"Are you sure you want to delete Malicious IP "+t.ip+"?",action:"delete-malicious-ip"}}).afterClosed().subscribe(o=>{this.refreshTable(),this.showTimedAlert("success","Updated successfully")})}refreshTable(){this.loading=!0,this.getMaliciousFileList()}AddMaliciousIP(){this.dialog.open(P,{width:"500px",disableClose:!1,data:{title:"Add Malicious IP",row:"",sep:"add"}}).afterClosed().subscribe(a=>{this.refreshTable(),this.showTimedAlert("success","Updated successfully")})}ngOnInit(){}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(g.N),e.Y36(e.sBO),e.Y36(d.uw))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-malware"]],decls:16,vars:7,consts:[[1,"flex","flex-auto","p-3","sm:p-5"],[1,"flex","flex-col","flex-auto","w-full"],["class","mb-8",4,"ngIf"],["class","flex justify-center items-center my-4",4,"ngIf"],[1,"grid","grid-cols-1","sm:grid-cols-1","lg:grid-cols-1","mb-4"],[1,"grid","grid-cols-2","sm:grid-cols-2","lg:grid-cols-2","rounded-t-xl","bg-primary-500"],[1,"justify-self-start","flex","items-center"],[1,"text-xl","font-bold","leading-none","tracking-tight","text-white","pl-5"],[1,"justify-self-end","m-2","mr-4"],["matTooltip","Add IP","class","px-2 mr-2 pt-1 bg-white text-white rounded-md",3,"disabled","click",4,"ngIf"],["matTooltip","Refresh","class","px-2 pt-1 bg-white text-white rounded-md",3,"disabled","click",4,"ngIf"],[1,"bg-card","rounded-b-2xl","grid","grid-cols-1","sm:grid-cols-1","lg:grid-cols-1","mb-4","rounded-b-2xl"],[1,"flex","flex-col","px-5","pt-4","pb-2","shadow","overflow-hidden","bg-card"],[3,"data","displayedColumns","headerMapping","editRow"],[1,"mb-8"],["class","mt-0 -mb-2",3,"appearance","showIcon","type",4,"ngIf"],[1,"mt-0","-mb-2",3,"appearance","showIcon","type"],[1,"flex","justify-center","items-center","my-4"],["mode","indeterminate",1,"w-full"],["matTooltip","Add IP",1,"px-2","mr-2","pt-1","bg-white","text-white","rounded-md",3,"disabled","click"],[1,"text-primary"],["matTooltip","Refresh",1,"px-2","pt-1","bg-white","text-white","rounded-md",3,"disabled","click"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,U,2,1,"div",2),e.YNc(3,S,2,0,"div",3),e.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7),e._uU(8," Malicious IP Database "),e.qZA()(),e.TgZ(9,"div",8),e.YNc(10,Y,3,1,"button",9),e.YNc(11,Q,3,1,"button",10),e.qZA()(),e.TgZ(12,"div",11)(13,"div")(14,"div",12)(15,"app-dynamic-table",13),e.NdJ("editRow",function(m){return a.onEditRow(m)}),e.qZA()()()()()()()),2&t&&(e.xp6(2),e.Q6J("ngIf",a.showAlert),e.xp6(1),e.Q6J("ngIf",a.loading),e.xp6(7),e.Q6J("ngIf",!a.loading),e.xp6(1),e.Q6J("ngIf",!a.loading),e.xp6(4),e.Q6J("data",a.blockedIps)("displayedColumns",a.displayedColumns)("headerMapping",a.headerMapping))},directives:[f.O5,h.W,x.pW,v.gM,n.Hw,F.Q],styles:[".custom-toggle .mat-slide-toggle-bar{background-color:#ef4444}.custom-toggle.mat-checked .mat-slide-toggle-bar{background-color:#22c55e!important}.custom-toggle .mat-slide-toggle-thumb{background-color:#fff}.custom-toggle.mat-checked .mat-slide-toggle-thumb{background-color:#22c55e!important}\n"],encapsulation:2}),s})();var E=i(8558),j=i(7775),D=i(797),O=i(9722),L=i(4095),k=i(5804);const H=[{path:"",component:R}];let W=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[I.Bz.forChild(H),p.ot,n.Ps,E.rP,j.fC,x.Cv,D.c,v.AV,c.lN,k.J,b.Cq,w.c,d.Is,L.Fk,O.LD,A.m]]}),s})()}}]);