"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[84],{5084:(pe,S,a)=>{a.r(S),a.d(S,{ModSecurityModule:()=>_e});var E=a(325),p=a(1377),c=a(1279),U=a(4466),P=a(5804),L=a(9971),s=a(3075),d=a(8341);const w=["SSLv2","SSLv3","TLSv1","TLSv1.1","TLSv1.2","TLSv1.3"],q=["TLS_AES_128_GCM_SHA256","TLS_AES_256_GCM_SHA384","TLS_CHACHA20_POLY1305_SHA256","TLS_AES_128_CCM_SHA256","TLS_AES_128_CCM_8_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384","TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384","TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256","TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256","TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA","TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA","TLS_DHE_RSA_WITH_AES_256_GCM_SHA384","TLS_DHE_RSA_WITH_AES_128_GCM_SHA256","TLS_DHE_RSA_WITH_AES_256_CBC_SHA256","TLS_DHE_RSA_WITH_AES_128_CBC_SHA256","TLS_DHE_RSA_WITH_AES_256_CBC_SHA","TLS_DHE_RSA_WITH_AES_128_CBC_SHA","TLS_RSA_WITH_AES_256_GCM_SHA384","TLS_RSA_WITH_AES_128_GCM_SHA256","TLS_RSA_WITH_AES_256_CBC_SHA256","TLS_RSA_WITH_AES_128_CBC_SHA256","TLS_RSA_WITH_AES_256_CBC_SHA","TLS_RSA_WITH_AES_128_CBC_SHA","TLS_PSK_WITH_AES_128_CBC_SHA","TLS_PSK_WITH_AES_256_CBC_SHA","TLS_PSK_WITH_AES_128_GCM_SHA256","TLS_RSA_WITH_CAMELLIA_256_CBC_SHA","TLS_RSA_WITH_CAMELLIA_128_CBC_SHA","TLS_ECDHE_RSA_WITH_CAMELLIA_256_CBC_SHA384","TLS_ECDHE_RSA_WITH_CAMELLIA_128_CBC_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256","TLS_RSA_WITH_3DES_EDE_CBC_SHA","TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA","TLS_RSA_WITH_RC4_128_SHA","TLS_RSA_WITH_RC4_128_MD5","TLS_RSA_WITH_NULL_SHA","TLS_RSA_WITH_NULL_MD5","TLS_RSA_WITH_DES_CBC_SHA","TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA","TLS_DHE_RSA_WITH_DES_CBC_SHA","TLS_ECDHE_RSA_WITH_NULL_SHA"],D=["GET","POST","PUT","PATCH","DELETE","HEAD","OPTIONS","CONNECT","TRACE"];function R(i){const n=i.value;return n?/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]?\d):(6553[0-5]|655[0-2]\d|65[0-4]\d{2}|6[0-4]\d{3}|[1-5]?\d{1,4})$/.test(n)?null:{invalidIpPort:!0}:null}function O(i){const n=i.value;if(!n)return null;const t=/^(25[0-5]|2[0-4]\d|1\d{2}|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d{2}|[1-9]?\d)){3}$/;return n.trim().split(/\s+/).every(r=>t.test(r))?null:{invalidMultiIPv4:!0}}var h=a(7221),A=a(1086),e=a(5e3),T=a(8125),u=a(9808),C=a(2494),g=a(1223),v=a(9722),N=a(6201),Z=a(6766),f=a(4095),x=a(6808);function F(i,n){if(1&i&&(e.TgZ(0,"fuse-alert",44),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.Q6J("appearance","soft")("showIcon",!0)("type",t.errorAlert.type),e.xp6(1),e.hij(" ",t.errorAlert.message," ")}}function J(i,n){if(1&i&&(e.TgZ(0,"mat-option",45),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function W(i,n){1&i&&(e.TgZ(0,"small",46),e._uU(1," Invalid Domain Name. "),e.qZA())}function Q(i,n){1&i&&(e.TgZ(0,"small",46),e._uU(1," Invalid IP and Port (e.g. 192.168.1.1:1234). "),e.qZA())}function B(i,n){1&i&&(e.TgZ(0,"small"),e._uU(1," Please enter a valid IP:Port (e.g., 192.168.0.1:8080) "),e.qZA())}function Y(i,n){1&i&&(e.TgZ(0,"small",46),e._uU(1," Invalid Entries. "),e.qZA())}function j(i,n){if(1&i&&(e.TgZ(0,"mat-option",45),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function V(i,n){if(1&i&&(e.TgZ(0,"mat-option",45),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function G(i,n){if(1&i&&(e.TgZ(0,"mat-option",45),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function K(i,n){1&i&&(e.TgZ(0,"small"),e._uU(1," Please enter valid space-separated IPv4 addresses (e.g., 8.8.8.8 1.1.1.1) "),e.qZA())}function k(i,n){1&i&&(e.TgZ(0,"small",46),e._uU(1," Invalid certificate. "),e.qZA())}function z(i,n){if(1&i&&(e.TgZ(0,"div",28)(1,"label",10),e._uU(2,"Certificate"),e.qZA(),e._UZ(3,"input",47),e.YNc(4,k,2,0,"small",14),e.qZA()),2&i){const t=e.oxw();let o;e.xp6(4),e.Q6J("ngIf",(null==(o=t.modSecForm.get("certificate"))?null:o.invalid)&&(null==(o=t.modSecForm.get("certificate"))?null:o.touched))}}function $(i,n){1&i&&(e.TgZ(0,"small",46),e._uU(1," Invalid key. "),e.qZA())}function X(i,n){if(1&i&&(e.TgZ(0,"div",28)(1,"label",10),e._uU(2,"Certificate Key"),e.qZA(),e._UZ(3,"input",48),e.YNc(4,$,2,0,"small",14),e.qZA()),2&i){const t=e.oxw();let o;e.xp6(4),e.Q6J("ngIf",(null==(o=t.modSecForm.get("certificateKey"))?null:o.invalid)&&(null==(o=t.modSecForm.get("certificateKey"))?null:o.touched))}}function ee(i,n){1&i&&e._UZ(0,"mat-progress-spinner",49),2&i&&e.Q6J("diameter",24)("mode","indeterminate")}let y=(()=>{class i{constructor(t,o,l,r,m){this.dialogRef=t,this.data=o,this.fb=l,this.getModSecService=r,this.cdr=m,this.errorAlert={type:"error",message:""},this.alert={type:"error",message:"Error! Duplicate Selection Found"},this.showAlert=!1,this.isSubmitting=!1,this.methodList=D,this.ifConfigList=["1.2.3.4","5.6.7.8","55.66.77.88"],this.sslProtocolList=w,this.sslCipherList=q,this.getIPConfigList(),console.log(),this.modSecForm=this.fb.group({listenIP:["",[s.kI.required]],domain:["",[s.kI.required]],localip:["",[s.kI.required,R]],webtype:["http"],modSec:["off"],certificate:[""],certificateKey:[""],ipwhitelist:[""],whiteMethod:[""],http2:["off"],ssl_session_cache_time:[],ssl_session_timeout_time:[],ssl_protocol:[],ssl_cipher:[],sslPreferServerCipher:["off"],dnsResolver:["",O],dnsResolverTimeout:[],maxBodySize:[],proxyBuffering:["off"],proxyRequestBuffering:["off"]})}ngOnInit(){var t;null===(t=this.modSecForm.get("webtype"))||void 0===t||t.valueChanges.subscribe(o=>{const l=this.modSecForm.get("certificate"),r=this.modSecForm.get("certificateKey");"https"===o?(null==l||l.enable(),null==r||r.enable(),null==l||l.setValidators([s.kI.required]),null==r||r.setValidators([s.kI.required])):(null==l||l.reset(),null==r||r.reset(),null==l||l.clearValidators(),null==r||r.clearValidators(),null==l||l.disable(),null==r||r.disable()),null==l||l.updateValueAndValidity(),null==r||r.updateValueAndValidity()})}getIPConfigList(){this.getModSecService.getIPConfigListAPI().pipe((0,h.K)(t=>(0,A.of)({api_status:"error",message:"Failed to fetch data"}))).subscribe(t=>{"success"===t.api_status?(this.ifConfigList=t.ip_list,console.log(this.ifConfigList)):this.showTimedAlert("error",t.message||"Unknown error")})}showTimedAlert(t,o){this.alert.type=t,this.alert.message=o,this.showAlert=!0,setTimeout(()=>{this.showAlert=!1},2e3)}closeDialog(){this.dialogRef.close("Dialog Closed")}onSubmit(){if(this.modSecForm.invalid)return this.showAlert=!0,this.errorAlert.message="Please fill all required fields correctly.",void(this.errorAlert.type="error");this.isSubmitting=!0;const t=this.modSecForm.value,o=new FormData;o.append("listenip",t.listenIP),o.append("domain",t.domain),o.append("localip",t.localip),o.append("Ipwhitelist",t.ipwhitelist),o.append("whiteMethod",t.whiteMethod),o.append("ssl_session_cache",t.ssl_session_cache_time),o.append("ssl_session_timeout",t.ssl_session_timeout_time),o.append("ssl_protocols",t.ssl_protocol),o.append("ssl_ciphers",t.ssl_cipher),o.append("dns_resolver",t.dnsResolver),o.append("resolver_timeout",t.dnsResolverTimeout),o.append("client_max_body_size",t.maxBodySize),o.append("webtype",t.webtype),o.append("modSec",t.modSec),o.append("http2",t.http2),o.append("ssl_prefer_server_ciphers",t.sslPreferServerCipher),o.append("proxy_buffering",t.proxyBuffering),o.append("proxy_request_buffering",t.proxyRequestBuffering),t.certificate&&t.certificateKey&&(o.append("certificate",t.certificate),o.append("certificatekey",t.certificateKey)),console.log(o),this.getModSecService.addModSecAPI(o).subscribe(l=>{this.isSubmitting=!1,this.showAlert=!0,this.alert.type="success",this.alert.message="ModSec configuration saved successfully!",this.cdr.detectChanges(),setTimeout(()=>{this.dialogRef.close(o)},2e3)},l=>{this.isSubmitting=!1,this.showAlert=!0,this.alert.type="error",this.alert.message="Failed to save Email Gateway configuration. Please try again.",console.error("Error:",l),this.cdr.detectChanges()})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(d.so),e.Y36(d.WI),e.Y36(s.qu),e.Y36(T.N),e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-mod-sec-form"]],decls:126,vars:35,consts:[[1,"dialog-content"],[1,"dialog-header","bg-primary","rounded-t-2xl","p-2","px-4","flex","justify-between","items-center"],[1,"text-xl","font-semibold","leading-none","tracking-tight","text-white"],["mat-icon-button","",3,"click"],[1,"text-white"],["class","mt-2",3,"appearance","showIcon","type",4,"ngIf"],[1,"rounded-lg",3,"formGroup","ngSubmit"],[1,"dialog-body"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-x-4","px-4"],["appearance","standard",1,"w-full"],[1,"block","font-semibold","mb-1"],["formControlName","listenIP"],[3,"value",4,"ngFor","ngForOf"],["matInput","","type","text","formControlName","domain","placeholder","abc.com"],["class","error",4,"ngIf"],[1,"block","font-semibold"],["matInput","","type","text","formControlName","localip","placeholder","192.168.1.1:1234"],[4,"ngIf"],["matInput","","type","text","formControlName","ipwhitelist","placeholder","1.2.3.4 , 111.222.333.444, 192.168.1.1/24"],["formControlName","whiteMethod","multiple",""],["matInput","","type","number","min","0","formControlName","ssl_session_cache_time","placeholder","Seconds"],["matInput","","type","number","min","0","formControlName","ssl_session_timeout_time","placeholder","Seconds"],["formControlName","ssl_protocol","multiple",""],["formControlName","ssl_cipher","multiple",""],["matInput","","type","text","formControlName","dnsResolver","placeholder","8.8.8.8"],["matInput","","type","number","min","0","formControlName","dnsResolverTimeout","placeholder","Seconds"],["matInput","","type","number","min","0","formControlName","maxBodySize","placeholder","MB"],[1,"border-t-2","border-gray-200","col-span-3","mb-3"],[1,"form-group"],[1,"flex","flex-row","justify-start"],[1,"font-semibold"],["formControlName","webtype",1,"flex","flex-row","mx-3",3,"color","value"],[1,"",3,"value"],[1,"ml-4",3,"value"],["formControlName","modSec",1,"flex","flex-row","mx-3",3,"color","value"],["formControlName","http2",1,"flex","flex-row","mx-3",3,"color","value"],["formControlName","sslPreferServerCipher",1,"flex","flex-row","mx-3",3,"color","value"],["formControlName","proxyBuffering",1,"flex","flex-row","mx-3",3,"color","value"],["formControlName","proxyRequestBuffering",1,"flex","flex-row","mx-3",3,"color","value"],[1,"border-t-2","border-gray-200","col-span-3","my-3"],["class","form-group",4,"ngIf"],["align","end",1,"mt-2"],["type","submit","mat-flat-button","",1,"fuse-mat-button-medium","w-28",3,"color","disabled"],["class","ml-3",3,"diameter","mode",4,"ngIf"],[1,"mt-2",3,"appearance","showIcon","type"],[3,"value"],[1,"error"],["type","file","formControlName","certificate","placeholder","abc.crt",1,"input-field"],["type","file","formControlName","certificateKey","placeholder","abc.key",1,"input-field"],[1,"ml-3",3,"diameter","mode"]],template:function(t,o){if(1&t&&(e.TgZ(0,"mat-dialog-content",0)(1,"div",1)(2,"div",2),e._uU(3),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return o.closeDialog()}),e.TgZ(5,"mat-icon",4),e._uU(6,"close"),e.qZA()()(),e.YNc(7,F,2,4,"fuse-alert",5),e.TgZ(8,"form",6),e.NdJ("ngSubmit",function(){return o.onSubmit()}),e.TgZ(9,"div",7)(10,"div",8)(11,"mat-form-field",9)(12,"mat-label",10),e._uU(13,"Listen IP"),e.qZA(),e.TgZ(14,"mat-select",11),e.YNc(15,J,2,2,"mat-option",12),e.qZA()(),e.TgZ(16,"mat-form-field",9)(17,"mat-label",10),e._uU(18,"Domain Name"),e.qZA(),e._UZ(19,"input",13),e.YNc(20,W,2,0,"small",14),e.qZA(),e.TgZ(21,"mat-form-field",9)(22,"mat-label",15),e._uU(23,"Local IP & Part"),e.qZA(),e._UZ(24,"input",16),e.YNc(25,Q,2,0,"small",14),e.YNc(26,B,2,0,"small",17),e.qZA(),e.TgZ(27,"mat-form-field",9)(28,"mat-label",15),e._uU(29,"IP Whitelisting"),e.qZA(),e._UZ(30,"input",18),e.YNc(31,Y,2,0,"small",14),e.qZA(),e.TgZ(32,"mat-form-field",9)(33,"mat-label",10),e._uU(34,"Whitelist Method"),e.qZA(),e.TgZ(35,"mat-select",19),e.YNc(36,j,2,2,"mat-option",12),e.qZA()(),e.TgZ(37,"mat-form-field",9)(38,"mat-label",15),e._uU(39,"SSL Session Cache (Seconds)"),e.qZA(),e._UZ(40,"input",20),e.qZA(),e.TgZ(41,"mat-form-field",9)(42,"mat-label",15),e._uU(43,"SSL Session Timeout (Seconds)"),e.qZA(),e._UZ(44,"input",21),e.qZA(),e.TgZ(45,"mat-form-field",9)(46,"mat-label",10),e._uU(47,"SSL Protocol"),e.qZA(),e.TgZ(48,"mat-select",22),e.YNc(49,V,2,2,"mat-option",12),e.qZA()(),e.TgZ(50,"mat-form-field",9)(51,"mat-label",10),e._uU(52,"SSL Cipher"),e.qZA(),e.TgZ(53,"mat-select",23),e.YNc(54,G,2,2,"mat-option",12),e.qZA()(),e.TgZ(55,"mat-form-field",9)(56,"mat-label",15),e._uU(57,"DNS Resolver"),e.qZA(),e._UZ(58,"input",24),e.YNc(59,K,2,0,"small",17),e.qZA(),e.TgZ(60,"mat-form-field",9)(61,"mat-label",15),e._uU(62,"DNS Resolver Timeout (Seconds)"),e.qZA(),e._UZ(63,"input",25),e.qZA(),e.TgZ(64,"mat-form-field",9)(65,"mat-label",15),e._uU(66,"Max Body Size"),e.qZA(),e._UZ(67,"input",26),e.qZA(),e._UZ(68,"div",27),e.TgZ(69,"div",28)(70,"div",29)(71,"span",30),e._uU(72,"Website Type:"),e.qZA(),e.TgZ(73,"mat-radio-group",31)(74,"mat-radio-button",32),e._uU(75," HTTPS "),e.qZA(),e.TgZ(76,"mat-radio-button",33),e._uU(77," HTTP "),e.qZA()()()(),e.TgZ(78,"div",29)(79,"span",30),e._uU(80,"MOD Security:"),e.qZA(),e.TgZ(81,"mat-radio-group",34)(82,"mat-radio-button",32),e._uU(83," On "),e.qZA(),e.TgZ(84,"mat-radio-button",33),e._uU(85," Off "),e.qZA()()(),e.TgZ(86,"div",29)(87,"span",30),e._uU(88,"HTTP2"),e.qZA(),e.TgZ(89,"mat-radio-group",35)(90,"mat-radio-button",32),e._uU(91," On "),e.qZA(),e.TgZ(92,"mat-radio-button",33),e._uU(93," Off "),e.qZA()()(),e.TgZ(94,"div",29)(95,"span",30),e._uU(96,"SSL Prefer Server Cipher "),e.qZA(),e.TgZ(97,"mat-radio-group",36)(98,"mat-radio-button",32),e._uU(99," On "),e.qZA(),e.TgZ(100,"mat-radio-button",33),e._uU(101," Off "),e.qZA()()(),e.TgZ(102,"div",29)(103,"span",30),e._uU(104,"Proxy Buffering "),e.qZA(),e.TgZ(105,"mat-radio-group",37)(106,"mat-radio-button",32),e._uU(107," On "),e.qZA(),e.TgZ(108,"mat-radio-button",33),e._uU(109," Off "),e.qZA()()(),e.TgZ(110,"div",29)(111,"span",30),e._uU(112,"Proxy Request Buffering "),e.qZA(),e.TgZ(113,"mat-radio-group",38)(114,"mat-radio-button",32),e._uU(115," On "),e.qZA(),e.TgZ(116,"mat-radio-button",33),e._uU(117," Off "),e.qZA()()(),e._UZ(118,"div",39),e.YNc(119,z,5,1,"div",40),e.YNc(120,X,5,1,"div",40),e.qZA()(),e.TgZ(121,"div",41)(122,"button",42)(123,"span"),e._uU(124," Update "),e.qZA(),e.YNc(125,ee,1,2,"mat-progress-spinner",43),e.qZA()()()()),2&t){let l,r,m,_,M,H,I;e.xp6(3),e.hij(" ",o.data.title," "),e.xp6(4),e.Q6J("ngIf",o.showAlert),e.xp6(1),e.Q6J("formGroup",o.modSecForm),e.xp6(7),e.Q6J("ngForOf",o.ifConfigList),e.xp6(5),e.Q6J("ngIf",(null==(l=o.modSecForm.get("domain"))?null:l.invalid)&&(null==(l=o.modSecForm.get("domain"))?null:l.touched)),e.xp6(5),e.Q6J("ngIf",(null==(r=o.modSecForm.get("localip"))?null:r.invalid)&&(null==(r=o.modSecForm.get("localip"))?null:r.touched)),e.xp6(1),e.Q6J("ngIf",null==(m=o.modSecForm.get("listenIP"))?null:m.hasError("invalidIpPort")),e.xp6(5),e.Q6J("ngIf",(null==(_=o.modSecForm.get("ipwhitelist"))?null:_.invalid)&&(null==(_=o.modSecForm.get("ipwhitelist"))?null:_.touched)),e.xp6(5),e.Q6J("ngForOf",o.methodList),e.xp6(13),e.Q6J("ngForOf",o.sslProtocolList),e.xp6(5),e.Q6J("ngForOf",o.sslCipherList),e.xp6(5),e.Q6J("ngIf",null==(M=o.modSecForm.get("dnsResolver"))?null:M.hasError("multiIPv4DNSResolverValidator")),e.xp6(14),e.Q6J("color","primary"),e.xp6(1),e.Q6J("value","https"),e.xp6(2),e.Q6J("value","http"),e.xp6(5),e.Q6J("color","primary"),e.xp6(1),e.Q6J("value","on"),e.xp6(2),e.Q6J("value","off"),e.xp6(5),e.Q6J("color","primary"),e.xp6(1),e.Q6J("value","on"),e.xp6(2),e.Q6J("value","off"),e.xp6(5),e.Q6J("color","primary"),e.xp6(1),e.Q6J("value","on"),e.xp6(2),e.Q6J("value","off"),e.xp6(5),e.Q6J("color","primary"),e.xp6(1),e.Q6J("value","on"),e.xp6(2),e.Q6J("value","off"),e.xp6(5),e.Q6J("color","primary"),e.xp6(1),e.Q6J("value","on"),e.xp6(2),e.Q6J("value","off"),e.xp6(3),e.Q6J("ngIf","https"===(null==(H=o.modSecForm.get("webtype"))?null:H.value)),e.xp6(1),e.Q6J("ngIf","https"===(null==(I=o.modSecForm.get("webtype"))?null:I.value)),e.xp6(2),e.Q6J("color","primary")("disabled",o.modSecForm.invalid||o.modSecForm.hasError("nonUniqueSelection")),e.xp6(3),e.Q6J("ngIf",o.isSubmitting)}},directives:[d.xY,p.lW,c.Hw,u.O5,C.W,s._Y,s.JL,s.sg,g.KE,g.hX,v.gD,s.JJ,s.u,u.sg,N.ey,Z.Nt,s.Fj,s.qQ,s.wV,f.VQ,f.U0,x.Ou],styles:[".dialog-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:auto;overflow:auto}.dialog-content[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #ddd;padding-bottom:10px}.dialog-content[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:20px}.dialog-content[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:transparent;border:none;cursor:pointer}.dialog-content[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px}.dialog-content[_ngcontent-%COMP%]   .dialog-body[_ngcontent-%COMP%]{padding-top:10px}.dialog-content[_ngcontent-%COMP%]   .dialog-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0}.dialog-footer[_ngcontent-%COMP%]{border-top:1px solid #ddd;margin-top:5px;padding-top:5px}mat-dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding-top:5px}mat-dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:8px}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-weight:700;margin-bottom:5px}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:8px;border:1px solid #ccc;border-radius:5px}.form-group[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{color:red;font-size:12px}.form-actions[_ngcontent-%COMP%]{margin-top:20px;display:flex;gap:10px}.form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px 15px;border:none;cursor:pointer;font-size:14px;border-radius:5px}.form-actions[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.form-actions[_ngcontent-%COMP%]   button[type=button][_ngcontent-%COMP%]{background-color:#ccc}.form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background-color:gray;cursor:not-allowed}"]}),i})(),te=(()=>{class i{constructor(t,o){this.dialogRef=t,this.data=o,this.inputData=this.data.row,console.log(this.data.row)}ngOnInit(){}closeDialog(){this.dialogRef.close("Dialog Closed")}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(d.so),e.Y36(d.WI))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-view-mod-sec-details"]],decls:75,vars:18,consts:[[1,"dialog-content"],[1,"dialog-header","bg-primary","rounded-t-2xl","p-2","px-4","flex","justify-between","items-center"],[1,"text-xl","font-semibold","leading-none","tracking-tight","text-white"],["mat-icon-button","",3,"click"],[1,"text-white"],[1,"dialog-body"],[1,"bg-white","p-3","mx-auto"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","text-md","text-gray-700"]],template:function(t,o){1&t&&(e.TgZ(0,"mat-dialog-content",0)(1,"div",1)(2,"div",2),e._uU(3),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return o.closeDialog()}),e.TgZ(5,"mat-icon",4),e._uU(6,"close"),e.qZA()()(),e.TgZ(7,"div",5)(8,"div")(9,"div",6)(10,"div",7)(11,"div")(12,"strong"),e._uU(13,"IP & Port:"),e.qZA(),e._uU(14),e.qZA(),e.TgZ(15,"div")(16,"strong"),e._uU(17,"ModSecurity:"),e.qZA(),e._uU(18),e.qZA(),e.TgZ(19,"div")(20,"strong"),e._uU(21,"Web Type:"),e.qZA(),e._uU(22),e.qZA(),e.TgZ(23,"div")(24,"strong"),e._uU(25,"IP Whitelist:"),e.qZA(),e._uU(26),e.qZA(),e.TgZ(27,"div")(28,"strong"),e._uU(29,"Method Whitelist:"),e.qZA(),e._uU(30),e.qZA(),e.TgZ(31,"div")(32,"strong"),e._uU(33,"HTTP2:"),e.qZA(),e._uU(34),e.qZA(),e.TgZ(35,"div")(36,"strong"),e._uU(37,"SSL Session Cache:"),e.qZA(),e._uU(38),e.qZA(),e.TgZ(39,"div")(40,"strong"),e._uU(41,"SSL Session Timeout:"),e.qZA(),e._uU(42),e.qZA(),e.TgZ(43,"div")(44,"strong"),e._uU(45,"SSL Protocols:"),e.qZA(),e._uU(46),e.qZA(),e.TgZ(47,"div")(48,"strong"),e._uU(49,"SSL Ciphers:"),e.qZA(),e._uU(50),e.qZA(),e.TgZ(51,"div")(52,"strong"),e._uU(53,"SSL Prefer Server Ciphers:"),e.qZA(),e._uU(54),e.qZA(),e.TgZ(55,"div")(56,"strong"),e._uU(57,"DNS Resolver:"),e.qZA(),e._uU(58),e.qZA(),e.TgZ(59,"div")(60,"strong"),e._uU(61,"Resolver Timeout:"),e.qZA(),e._uU(62),e.qZA(),e.TgZ(63,"div")(64,"strong"),e._uU(65,"Client Max Body Size:"),e.qZA(),e._uU(66),e.qZA(),e.TgZ(67,"div")(68,"strong"),e._uU(69,"Proxy Buffering:"),e.qZA(),e._uU(70),e.qZA(),e.TgZ(71,"div")(72,"strong"),e._uU(73,"Proxy Request Buffering:"),e.qZA(),e._uU(74),e.qZA()()()()()()),2&t&&(e.xp6(3),e.AsE(" ",o.data.title," - ",o.inputData.domain_name," "),e.xp6(11),e.hij(" ",o.inputData.ip_port,""),e.xp6(4),e.hij(" ",o.inputData.modSec,""),e.xp6(4),e.hij(" ",o.inputData.web_type,""),e.xp6(4),e.hij(" ",o.inputData.ip_whitelist,""),e.xp6(4),e.hij(" ",o.inputData.method_whitelist,""),e.xp6(4),e.hij(" ",o.inputData.http2,""),e.xp6(4),e.hij(" ",o.inputData.ssl_session_cache,""),e.xp6(4),e.hij(" ",o.inputData.ssl_session_timeout,""),e.xp6(4),e.hij(" ",o.inputData.ssl_protocols,""),e.xp6(4),e.hij(" ",o.inputData.ssl_ciphers,""),e.xp6(4),e.hij(" ",o.inputData.ssl_prefer_server_ciphers,""),e.xp6(4),e.hij(" ",o.inputData.dns_resolver,""),e.xp6(4),e.hij(" ",o.inputData.resolver_timeout,""),e.xp6(4),e.hij(" ",o.inputData.client_max_body_size,""),e.xp6(4),e.hij(" ",o.inputData.proxy_buffering,""),e.xp6(4),e.hij(" ",o.inputData.proxy_request_buffering,""))},directives:[d.xY,p.lW,c.Hw],styles:[""]}),i})();var b=a(1101),oe=a(1218);function ie(i,n){if(1&i&&(e.TgZ(0,"fuse-alert",15),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.Q6J("appearance","outline")("showIcon",!0)("type",t.alert.type),e.xp6(1),e.hij(" ",t.alert.message," ")}}function ne(i,n){if(1&i&&(e.TgZ(0,"div",13),e.YNc(1,ie,2,4,"fuse-alert",14),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.showAlert)}}function le(i,n){1&i&&(e.TgZ(0,"div",16),e._UZ(1,"mat-progress-bar",17),e.qZA())}function re(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",18),e.NdJ("click",function(){return e.CHM(t),e.oxw().refreshTable()}),e.TgZ(1,"mat-icon",19),e._uU(2,"refresh"),e.qZA()()}if(2&i){const t=e.oxw();e.Q6J("disabled",t.loading)}}function ae(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",20),e.NdJ("click",function(){return e.CHM(t),e.oxw().addWebsiteModSec()}),e.TgZ(1,"mat-icon",19),e._uU(2,"add"),e.qZA()()}if(2&i){const t=e.oxw();e.Q6J("disabled",t.loading)}}let se=(()=>{class i{constructor(t,o){this.dialog=t,this.getModSecService=o,this.alert={type:"success",message:""},this.showAlert=!1,this.loading=!0,this.data=[],this.headerMapping={domain_name:"Website Name",ip_port:"IP",modSec:"Mod Security Status",web_type:"Type",http2:"HTTP2",method_whitelist:"Method Whitelisting",modSec_action:"Action"},this.displayedColumns=["domain_name","ip_port","modSec","web_type","http2","method_whitelist","modSec_action"],this.getModSecInfo()}refreshTable(){this.getModSecInfo()}getModSecInfo(){this.loading=!0,this.getModSecService.getModSecListAPI().pipe((0,h.K)(t=>(0,A.of)({api_status:"error",message:"Failed to fetch data"}))).subscribe(t=>{this.showAlert=!1,this.data=t,console.log(t),this.loading=!1,this.showAlert=!0,this.showTimedAlert("success","Updated Successfully"),this.alert.message="Updated Successfully",this.alert.type="success"})}addWebsiteModSec(){this.dialog.open(y,{width:"900px",disableClose:!0,data:{title:"Add Mod Security",row:"",sep:"add"}}).afterClosed().subscribe(o=>{this.refreshTable(),this.showTimedAlert("success","Updated successfully")})}showTimedAlert(t,o){this.alert.type=t,this.alert.message=o,this.showAlert=!0,setTimeout(()=>{this.showAlert=!1},2e3)}onEditRow(t){"modsec-delete"==t.sep?this.dialog.open(L.d,{width:"700px",disableClose:!0,data:{title:"Delete Website Mod Security",row:t,message:"Are you sure you want to delete Website Mod Security?",action:"delete-web-mod-sec"}}).afterClosed().subscribe(l=>{this.refreshTable(),this.showTimedAlert("success","Updated successfully")}):"modsec-edit"==t.sep?this.dialog.open(y,{width:"900px",data:{title:"Edit Mod Security",row:t,sep:"edit"}}).afterClosed().subscribe(l=>{this.refreshTable(),this.showTimedAlert("success","Updated successfully")}):"modsec-view"==t.sep&&this.dialog.open(te,{width:"700px",data:{title:"View Mod Security",row:t,sep:"view"}}).afterClosed().subscribe(l=>{})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(d.uw),e.Y36(T.N))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-mod-security"]],decls:14,vars:7,consts:[[1,"flex","flex-auto","p-3","sm:p-5"],[1,"flex","flex-col","flex-auto","w-full"],["class","mb-8",4,"ngIf"],["class","flex justify-center items-center my-4",4,"ngIf"],[1,"grid","grid-cols-1","sm:grid-cols-1","lg:grid-cols-1"],[1,"grid","grid-cols-2","sm:grid-cols-2","lg:grid-cols-2","rounded-t-xl","bg-primary-500"],[1,"justify-self-start","flex","items-center"],[1,"text-xl","font-bold","leading-none","tracking-tight","text-white","pl-5"],[1,"justify-self-end","m-2","mr-4"],["class","px-1 pt-1 bg-white text-white rounded-3xl",3,"disabled","click",4,"ngIf"],["class","px-1 ml-2 pt-1 bg-white text-white rounded-3xl",3,"disabled","click",4,"ngIf"],[1,"bg-card","p-4","rounded-b-xl"],[3,"data","displayedColumns","headerMapping","editRow"],[1,"mb-8"],["class","mt-0 -mb-2",3,"appearance","showIcon","type",4,"ngIf"],[1,"mt-0","-mb-2",3,"appearance","showIcon","type"],[1,"flex","justify-center","items-center","my-4"],["mode","indeterminate",1,"w-full"],[1,"px-1","pt-1","bg-white","text-white","rounded-3xl",3,"disabled","click"],[1,"text-primary"],[1,"px-1","ml-2","pt-1","bg-white","text-white","rounded-3xl",3,"disabled","click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,ne,2,1,"div",2),e.YNc(3,le,2,0,"div",3),e.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7),e._uU(8," Mod Security "),e.qZA()(),e.TgZ(9,"div",8),e.YNc(10,re,3,1,"button",9),e.YNc(11,ae,3,1,"button",10),e.qZA()()(),e.TgZ(12,"div",11)(13,"app-dynamic-table",12),e.NdJ("editRow",function(r){return o.onEditRow(r)}),e.qZA()()()()),2&t&&(e.xp6(2),e.Q6J("ngIf",o.showAlert),e.xp6(1),e.Q6J("ngIf",o.loading),e.xp6(7),e.Q6J("ngIf",!o.loading),e.xp6(1),e.Q6J("ngIf",!o.loading),e.xp6(2),e.Q6J("data",o.data)("displayedColumns",o.displayedColumns)("headerMapping",o.headerMapping))},directives:[u.O5,C.W,b.pW,c.Hw,oe.Q],styles:[""]}),i})();var de=a(7775),ce=a(797);const me=[{path:"",component:se}];let _e=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[E.Bz.forChild(me),p.ot,c.Ps,P.J,de.fC,b.Cv,ce.c,x.Cq,g.lN,Z.c,d.Is,f.Fk,v.LD,U.m]]}),i})()}}]);