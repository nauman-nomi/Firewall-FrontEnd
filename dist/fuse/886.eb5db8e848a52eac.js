"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[886],{886:(L,g,l)=>{l.r(g),l.d(g,{EmailGWModule:()=>B});var C=l(325),u=l(1377),c=l(1279),v=l(4466),G=l(9971),r=l(3075),m=l(8341),t=l(5e3),f=l(8125),h=l(9808),w=l(2494),p=l(4095),x=l(6808);function T(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"fuse-alert",25),t.NdJ("dismissed",function(){return t.CHM(e),t.oxw().showAlert=!1}),t._uU(1),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("type",e.alert.type)("dismissible",!0),t.xp6(1),t.hij(" ",e.alert.message," ")}}function Z(o,a){1&o&&(t.TgZ(0,"small",26),t._uU(1," Invalid Domain Name. "),t.qZA())}function E(o,a){1&o&&(t.TgZ(0,"small",26),t._uU(1," e.g. 192.168.1.1 "),t.qZA())}function A(o,a){1&o&&(t.TgZ(0,"small",26),t._uU(1," e.g. 443 "),t.qZA())}function F(o,a){1&o&&(t.TgZ(0,"small",26),t._uU(1," Certificate file is required. "),t.qZA())}function M(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",27)(1,"label",16),t._uU(2,"Certificate"),t.qZA(),t.TgZ(3,"input",28),t.NdJ("change",function(n){return t.CHM(e),t.oxw().onFileSelected(n)}),t.qZA(),t.YNc(4,F,2,0,"small",18),t.qZA()}if(2&o){const e=t.oxw();let i;t.xp6(3),t.Q6J("disabled","443"!==(null==(i=e.emailGWForm.get("smtptype"))?null:i.value)),t.xp6(1),t.Q6J("ngIf",!e.selectedFile&&e.isSubmitting)}}function P(o,a){1&o&&t._UZ(0,"mat-progress-spinner",29),2&o&&t.Q6J("diameter",24)("mode","indeterminate")}let y=(()=>{class o{constructor(e,i,n,s,d){this.dialogRef=e,this.data=i,this.nicService=n,this.fb=s,this.cdr=d,this.errorAlert={type:"error",message:""},this.alert={type:"error",message:""},this.showAlert=!1,this.isSubmitting=!1,this.selectedFile=null,this.emailGWForm=this.fb.group({smtptype:["",[r.kI.required]],domain:["",[r.kI.required]],ip_address:["",[r.kI.required,r.kI.pattern(/^(\d{1,3}\.){3}\d{1,3}$/)]],port:["",[r.kI.required]]})}ngOnInit(){var e;null===(e=this.emailGWForm.get("smtptype"))||void 0===e||e.valueChanges.subscribe(i=>{var n,s;"25"===i?null===(n=this.emailGWForm.get("port"))||void 0===n||n.setValue("25"):"443"===i&&(null===(s=this.emailGWForm.get("port"))||void 0===s||s.setValue("443"))})}onFileSelected(e){const i=e.target.files[0];i&&(this.selectedFile=i)}onSubmit(){var e;if(this.emailGWForm.invalid)return this.showAlert=!0,this.errorAlert.message="Please fill all required fields correctly.",void(this.errorAlert.type="error");if("443"===(null===(e=this.emailGWForm.get("smtptype"))||void 0===e?void 0:e.value)&&!this.selectedFile)return this.showAlert=!0,this.errorAlert.message="Certificate file is required for SMTPS.",void(this.errorAlert.type="error");this.isSubmitting=!0;const i=this.emailGWForm.value,n=new FormData;n.append("domain",i.domain),n.append("smtptype",i.smtptype),n.append("ip_address",i.ip_address),n.append("port",i.port),"443"===i.smtptype&&this.selectedFile&&n.append("pem_file",this.selectedFile,this.selectedFile.name),console.log("FormData about to be sent:");for(const s of n.entries())console.log(s[0],s[1]);this.nicService.addEmailGw(n).subscribe(s=>{this.isSubmitting=!1,this.showAlert=!0,this.alert.type="success",this.alert.message="Email Gateway configuration saved successfully!",this.cdr.detectChanges(),setTimeout(()=>{this.dialogRef.close(n)},2e3)},s=>{this.isSubmitting=!1,this.showAlert=!0,this.alert.type="error",this.alert.message="Failed to save Email Gateway configuration. Please try again.",console.error("Error:",s),this.cdr.detectChanges()})}closeDialog(){this.dialogRef.close("Dialog Closed")}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(m.so),t.Y36(m.WI),t.Y36(f.N),t.Y36(r.qu),t.Y36(t.sBO))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-email-gw-form"]],decls:41,vars:13,consts:[[1,"dialog-content"],[1,"dialog-header","bg-primary","rounded-t-2xl","p-2","px-4","flex","justify-between","items-center"],[1,"text-xl","font-semibold","leading-none","tracking-tight","text-white"],["mat-icon-button","",3,"click"],[1,"text-white"],[3,"type","dismissible","dismissed",4,"ngIf"],[1,"rounded-lg",3,"formGroup","ngSubmit"],[1,"dialog-body","mt-3"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-2","px-4"],[1,"form-group","col-span-3"],[1,"flex","flex-row","justify-start"],[1,"font-semibold"],["formControlName","smtptype",1,"flex","flex-row","mx-3",3,"color"],[3,"value"],[1,"ml-4",3,"value"],[1,"form-group"],[1,"block","font-semibold","mb-1"],["type","text","formControlName","domain","placeholder","abc.com",1,"input-field"],["class","error",4,"ngIf"],["type","text","formControlName","ip_address","placeholder","192.168.1.1",1,"input-field"],["type","text","formControlName","port","placeholder","443",1,"input-field"],["class","form-group col-span-2",4,"ngIf"],["align","end",1,"mt-2"],["type","submit","mat-flat-button","",1,"fuse-mat-button-medium","w-28",3,"color","disabled"],["class","ml-3",3,"diameter","mode",4,"ngIf"],[3,"type","dismissible","dismissed"],[1,"error"],[1,"form-group","col-span-2"],["type","file",1,"input-field",3,"disabled","change"],[1,"ml-3",3,"diameter","mode"]],template:function(e,i){if(1&e&&(t.TgZ(0,"mat-dialog-content",0)(1,"div",1)(2,"div",2),t._uU(3),t.qZA(),t.TgZ(4,"button",3),t.NdJ("click",function(){return i.closeDialog()}),t.TgZ(5,"mat-icon",4),t._uU(6,"close"),t.qZA()()(),t.YNc(7,T,2,3,"fuse-alert",5),t.TgZ(8,"form",6),t.NdJ("ngSubmit",function(){return i.onSubmit()}),t.TgZ(9,"div",7)(10,"div",8)(11,"div",9)(12,"div",10)(13,"span",11),t._uU(14,"Type:"),t.qZA(),t.TgZ(15,"mat-radio-group",12)(16,"mat-radio-button",13),t._uU(17,"SMTP"),t.qZA(),t.TgZ(18,"mat-radio-button",14),t._uU(19,"SMTPS"),t.qZA()()()(),t.TgZ(20,"div",15)(21,"label",16),t._uU(22,"Domain Name"),t.qZA(),t._UZ(23,"input",17),t.YNc(24,Z,2,0,"small",18),t.qZA(),t.TgZ(25,"div",15)(26,"label",16),t._uU(27,"IP:"),t.qZA(),t._UZ(28,"input",19),t.YNc(29,E,2,0,"small",18),t.qZA(),t.TgZ(30,"div",15)(31,"label",16),t._uU(32,"Port:"),t.qZA(),t._UZ(33,"input",20),t.YNc(34,A,2,0,"small",18),t.qZA(),t.YNc(35,M,5,2,"div",21),t.qZA()(),t.TgZ(36,"div",22)(37,"button",23)(38,"span"),t._uU(39," Update "),t.qZA(),t.YNc(40,P,1,2,"mat-progress-spinner",24),t.qZA()()()()),2&e){let n,s,d,_;t.xp6(3),t.hij(" ",i.data.title," "),t.xp6(4),t.Q6J("ngIf",i.showAlert),t.xp6(1),t.Q6J("formGroup",i.emailGWForm),t.xp6(7),t.Q6J("color","primary"),t.xp6(1),t.Q6J("value","25"),t.xp6(2),t.Q6J("value","443"),t.xp6(6),t.Q6J("ngIf",(null==(n=i.emailGWForm.get("domain"))?null:n.invalid)&&(null==(n=i.emailGWForm.get("domain"))?null:n.touched)),t.xp6(5),t.Q6J("ngIf",(null==(s=i.emailGWForm.get("ip_address"))?null:s.invalid)&&(null==(s=i.emailGWForm.get("ip_address"))?null:s.touched)),t.xp6(5),t.Q6J("ngIf",(null==(d=i.emailGWForm.get("port"))?null:d.invalid)&&(null==(d=i.emailGWForm.get("port"))?null:d.touched)),t.xp6(1),t.Q6J("ngIf","443"===(null==(_=i.emailGWForm.get("smtptype"))?null:_.value)),t.xp6(2),t.Q6J("color","primary")("disabled",i.emailGWForm.invalid||i.emailGWForm.hasError("nonUniqueSelection")),t.xp6(3),t.Q6J("ngIf",i.isSubmitting)}},directives:[m.xY,u.lW,c.Hw,h.O5,w.W,r._Y,r.JL,r.sg,p.VQ,r.JJ,r.u,p.U0,r.Fj,x.Ou],styles:[".dialog-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:auto;overflow:auto}.dialog-content[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #ddd;padding-bottom:10px}.dialog-content[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:20px}.dialog-content[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:transparent;border:none;cursor:pointer}.dialog-content[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px}.dialog-content[_ngcontent-%COMP%]   .dialog-body[_ngcontent-%COMP%]{padding-top:10px}.dialog-content[_ngcontent-%COMP%]   .dialog-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0}.dialog-footer[_ngcontent-%COMP%]{border-top:1px solid #ddd;margin-top:5px;padding-top:5px}mat-dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding-top:5px}mat-dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:8px}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-weight:700;margin-bottom:5px}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:8px;border:1px solid #ccc;border-radius:5px}.form-group[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{color:red;font-size:12px}.form-actions[_ngcontent-%COMP%]{margin-top:20px;display:flex;gap:10px}.form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px 15px;border:none;cursor:pointer;font-size:14px;border-radius:5px}.form-actions[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.form-actions[_ngcontent-%COMP%]   button[type=button][_ngcontent-%COMP%]{background-color:#ccc}.form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background-color:gray;cursor:not-allowed}"]}),o})();var O=l(7221),I=l(1086);let J=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-view-email-gw-details"]],decls:2,vars:0,template:function(e,i){1&e&&(t.TgZ(0,"p"),t._uU(1,"view-email-gw-details works!"),t.qZA())},styles:[""]}),o})();var b=l(1101),U=l(1218);function W(o,a){if(1&o&&(t.TgZ(0,"fuse-alert",15),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.Q6J("appearance","outline")("showIcon",!0)("type",e.alert.type),t.xp6(1),t.hij(" ",e.alert.message," ")}}function N(o,a){if(1&o&&(t.TgZ(0,"div",13),t.YNc(1,W,2,4,"fuse-alert",14),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.showAlert)}}function S(o,a){1&o&&(t.TgZ(0,"div",16),t._UZ(1,"mat-progress-bar",17),t.qZA())}function Q(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){return t.CHM(e),t.oxw().refreshTable()}),t.TgZ(1,"mat-icon",19),t._uU(2,"refresh"),t.qZA()()}if(2&o){const e=t.oxw();t.Q6J("disabled",e.loading)}}function Y(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){return t.CHM(e),t.oxw().addEmailGW()}),t.TgZ(1,"mat-icon",19),t._uU(2,"add"),t.qZA()()}if(2&o){const e=t.oxw();t.Q6J("disabled",e.loading)}}let q=(()=>{class o{constructor(e,i){this.dialog=e,this.getEmailGwService=i,this.alert={type:"success",message:""},this.showAlert=!1,this.loading=!0,this.data=[],this.headerMapping={domain:"Domain Name",ip:"IP",port:"Port",smtptype:"Type",emailgw_action:"Action"},this.displayedColumns=["domain","ip","port","smtptype","emailgw_action"],this.getEmailGwInfo()}refreshTable(){this.getEmailGwInfo()}getEmailGwInfo(){this.loading=!0,this.getEmailGwService.getEmailGwListAPI().pipe((0,O.K)(e=>(0,I.of)({api_status:"error",message:"Failed to fetch data"}))).subscribe(e=>{this.showAlert=!1,this.data=e.data,console.log(e),this.loading=!1,this.showAlert=!0,this.showTimedAlert("success","Updated Successfully"),this.alert.message="Updated Successfully",this.alert.type="success"})}ngOnInit(){}addEmailGW(){this.dialog.open(y,{width:"700px",data:{title:"Add Email Gateway",row:"",sep:"add"}}).afterClosed().subscribe(i=>{this.refreshTable(),this.showTimedAlert("success","Updated successfully")})}showTimedAlert(e,i){this.alert.type=e,this.alert.message=i,this.showAlert=!0,setTimeout(()=>{this.showAlert=!1},2e3)}onEditRow(e){"emailgw-delete"==e.sep?(console.log("delete"),console.log(e),this.dialog.open(G.d,{width:"700px",disableClose:!0,data:{title:"Delete Email Gateway Security",row:e,message:"Are you sure you want to delete Email Gateway Security?",action:"delete-email-gw-sec"}}).afterClosed().subscribe(n=>{this.refreshTable(),this.showTimedAlert("success","Updated successfully")})):"emailgw-edit"==e.sep?this.dialog.open(y,{width:"700px",data:{title:"Edit Email Gateway",row:e,sep:"edit"}}).afterClosed().subscribe(n=>{this.refreshTable(),this.showTimedAlert("success","Updated successfully")}):"emailgw-view"==e.sep&&this.dialog.open(J,{width:"700px",data:{title:"View Email Gateway",row:e,sep:"view"}}).afterClosed().subscribe(n=>{})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(m.uw),t.Y36(f.N))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-email-gateway"]],decls:14,vars:7,consts:[[1,"flex","flex-auto","p-3","sm:p-5"],[1,"flex","flex-col","flex-auto","w-full"],["class","mb-8",4,"ngIf"],["class","flex justify-center items-center my-4",4,"ngIf"],[1,"grid","grid-cols-1","sm:grid-cols-1","lg:grid-cols-1"],[1,"grid","grid-cols-2","sm:grid-cols-2","lg:grid-cols-2","rounded-t-xl","bg-primary-500"],[1,"justify-self-start","flex","items-center"],[1,"text-xl","font-bold","leading-none","tracking-tight","text-white","pl-5"],[1,"justify-self-end","m-2","mr-4"],["class","px-1 pt-1 bg-white text-white rounded-3xl",3,"disabled","click",4,"ngIf"],["class","px-1 ml-2 pt-1 bg-white text-white rounded-3xl",3,"disabled","click",4,"ngIf"],[1,"bg-card","p-4","rounded-b-xl"],[3,"data","displayedColumns","headerMapping","editRow"],[1,"mb-8"],["class","mt-0 -mb-2",3,"appearance","showIcon","type",4,"ngIf"],[1,"mt-0","-mb-2",3,"appearance","showIcon","type"],[1,"flex","justify-center","items-center","my-4"],["mode","indeterminate",1,"w-full"],[1,"px-1","pt-1","bg-white","text-white","rounded-3xl",3,"disabled","click"],[1,"text-primary"],[1,"px-1","ml-2","pt-1","bg-white","text-white","rounded-3xl",3,"disabled","click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,N,2,1,"div",2),t.YNc(3,S,2,0,"div",3),t.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7),t._uU(8," Email Gateway Security"),t.qZA()(),t.TgZ(9,"div",8),t.YNc(10,Q,3,1,"button",9),t.YNc(11,Y,3,1,"button",10),t.qZA()()(),t.TgZ(12,"div",11)(13,"app-dynamic-table",12),t.NdJ("editRow",function(s){return i.onEditRow(s)}),t.qZA()()()()),2&e&&(t.xp6(2),t.Q6J("ngIf",i.showAlert),t.xp6(1),t.Q6J("ngIf",i.loading),t.xp6(7),t.Q6J("ngIf",!i.loading),t.xp6(1),t.Q6J("ngIf",!i.loading),t.xp6(2),t.Q6J("data",i.data)("displayedColumns",i.displayedColumns)("headerMapping",i.headerMapping))},directives:[h.O5,w.W,b.pW,c.Hw,U.Q],styles:[""]}),o})();var R=l(5804),D=l(7775),j=l(797),V=l(1223),k=l(6766),H=l(9722);const z=[{path:"",component:q}];let B=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[C.Bz.forChild(z),u.ot,c.Ps,R.J,D.fC,b.Cv,j.c,x.Cq,V.lN,k.c,m.Is,p.Fk,H.LD,v.m]]}),o})()}}]);