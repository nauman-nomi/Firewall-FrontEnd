"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[527],{9527:(_,m,i)=>{i.r(m),i.d(m,{BlockIpsModule:()=>H});var A=i(325),u=i(1377),r=i(1279),y=i(4466),k=i(1086),T=i(7221),B=i(9971),d=i(3075),a=i(8341),t=i(5e3),f=i(8125),g=i(9808),h=i(2494),c=i(1223),I=i(6766),b=i(6808);function C(s,n){if(1&s){const e=t.EpF();t.TgZ(0,"fuse-alert",16),t.NdJ("dismissed",function(){return t.CHM(e),t.oxw().showAlert=!1}),t._uU(1),t.qZA()}if(2&s){const e=t.oxw();t.Q6J("type",e.alert.type)("dismissible",!0),t.xp6(1),t.hij(" ",e.alert.message," ")}}function w(s,n){1&s&&(t.TgZ(0,"small",17),t._uU(1," Invalid IP Address. "),t.qZA())}function Z(s,n){1&s&&t._UZ(0,"mat-progress-spinner",18),2&s&&t.Q6J("diameter",24)("mode","indeterminate")}let J=(()=>{class s{constructor(e,o,l,p,W){this.dialogRef=e,this.data=o,this.nicService=l,this.cdr=p,this.fb=W,this.errorAlert={type:"error",message:""},this.alert={type:"error",message:"Error!"},this.showAlert=!1,this.isSubmitting=!1,console.log(this.data.row),this.addBlockIPForm=this.fb.group({ip_address:["",[d.kI.required,d.kI.pattern(/^(\d{1,3}\.){3}\d{1,3}((:\d{1,5})|(\/\d{1,2}))?$/)]]})}ngOnInit(){}closeDialog(){this.dialogRef.close("Dialog Closed")}onSubmit(){if(this.addBlockIPForm.invalid)return this.showAlert=!0,this.errorAlert.message="Please fill all required fields correctly.",void(this.errorAlert.type="error");this.isSubmitting=!0;const e=this.addBlockIPForm.value,o=new FormData;o.append("ip_address",e.ip_address),this.nicService.addBlockIP(o).subscribe(l=>{this.isSubmitting=!1,this.showAlert=!0,this.alert.type="success",this.alert.message="IP Added successfully!",this.cdr.detectChanges(),setTimeout(()=>{this.dialogRef.close(o)},2e3)},l=>{this.isSubmitting=!1,this.showAlert=!0,this.alert.type="error",this.alert.message="Failed to add IP address. Please try again.",console.error("Error:",l),this.cdr.detectChanges()})}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(a.so),t.Y36(a.WI),t.Y36(f.N),t.Y36(t.sBO),t.Y36(d.qu))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-add-block-ip"]],decls:21,vars:7,consts:[[1,"dialog-content"],[1,"dialog-header","bg-primary","rounded-t-2xl","p-2","px-4","flex","justify-between","items-center"],[1,"text-xl","font-semibold","leading-none","tracking-tight","text-white"],["mat-icon-button","",3,"click"],[1,"text-white"],[3,"type","dismissible","dismissed",4,"ngIf"],[1,"rounded-lg",3,"formGroup","ngSubmit"],[1,"dialog-body"],[1,"flex","justify-center","px-3"],["appearance","standard",1,"w-full"],[1,"block","font-semibold","mb-1"],["matInput","","type","text","formControlName","ip_address","placeholder","x.x.x.x"],["class","error",4,"ngIf"],["align","end",1,"mt-2"],["type","submit","mat-flat-button","",1,"fuse-mat-button-medium","w-28",3,"color","disabled"],["class","ml-3",3,"diameter","mode",4,"ngIf"],[3,"type","dismissible","dismissed"],[1,"error"],[1,"ml-3",3,"diameter","mode"]],template:function(e,o){if(1&e&&(t.TgZ(0,"mat-dialog-content",0)(1,"div",1)(2,"div",2),t._uU(3),t.qZA(),t.TgZ(4,"button",3),t.NdJ("click",function(){return o.closeDialog()}),t.TgZ(5,"mat-icon",4),t._uU(6,"close"),t.qZA()()(),t.YNc(7,C,2,3,"fuse-alert",5),t.TgZ(8,"form",6),t.NdJ("ngSubmit",function(){return o.onSubmit()}),t.TgZ(9,"div",7)(10,"div",8)(11,"mat-form-field",9)(12,"mat-label",10),t._uU(13,"Enter IP Address"),t.qZA(),t._UZ(14,"input",11),t.YNc(15,w,2,0,"small",12),t.qZA()()(),t.TgZ(16,"div",13)(17,"button",14)(18,"span"),t._uU(19," Submit "),t.qZA(),t.YNc(20,Z,1,2,"mat-progress-spinner",15),t.qZA()()()()),2&e){let l;t.xp6(3),t.hij(" ",o.data.title," "),t.xp6(4),t.Q6J("ngIf",o.showAlert),t.xp6(1),t.Q6J("formGroup",o.addBlockIPForm),t.xp6(7),t.Q6J("ngIf",(null==(l=o.addBlockIPForm.get("ip_address"))?null:l.invalid)&&(null==(l=o.addBlockIPForm.get("ip_address"))?null:l.touched)),t.xp6(2),t.Q6J("color","primary")("disabled",o.addBlockIPForm.invalid||o.addBlockIPForm.hasError("nonUniqueSelection")),t.xp6(3),t.Q6J("ngIf",o.isSubmitting)}},directives:[a.xY,u.lW,r.Hw,g.O5,h.W,d._Y,d.JL,d.sg,c.KE,c.hX,I.Nt,d.Fj,d.JJ,d.u,b.Ou],styles:[""]}),s})();var x=i(1101),v=i(9824),P=i(1218);function F(s,n){if(1&s&&(t.TgZ(0,"fuse-alert",16),t._uU(1),t.qZA()),2&s){const e=t.oxw(2);t.Q6J("appearance","outline")("showIcon",!0)("type",e.alert.type),t.xp6(1),t.hij(" ",e.alert.message," ")}}function N(s,n){if(1&s&&(t.TgZ(0,"div",14),t.YNc(1,F,2,4,"fuse-alert",15),t.qZA()),2&s){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.showAlert)}}function S(s,n){1&s&&(t.TgZ(0,"div",17),t._UZ(1,"mat-progress-bar",18),t.qZA())}function U(s,n){if(1&s){const e=t.EpF();t.TgZ(0,"button",19),t.NdJ("click",function(){return t.CHM(e),t.oxw().AddBlockIP()}),t.TgZ(1,"mat-icon",20),t._uU(2,"add"),t.qZA()()}if(2&s){const e=t.oxw();t.Q6J("disabled",e.loading)}}function Y(s,n){if(1&s){const e=t.EpF();t.TgZ(0,"button",21),t.NdJ("click",function(){return t.CHM(e),t.oxw().refreshTable()}),t.TgZ(1,"mat-icon",20),t._uU(2,"refresh"),t.qZA()()}if(2&s){const e=t.oxw();t.Q6J("disabled",e.loading)}}let Q=(()=>{class s{constructor(e,o,l){this.apiService=e,this.cdr=o,this.dialog=l,this.alert={type:"success",message:""},this.showAlert=!1,this.loading=!1,this.headerMapping={ip:"IP",block_status:"Status",block_action:"Action"},this.displayedColumns=["ip","block_status","block_action"],this.blockIps=[],this.getBlockFileList()}showTimedAlert(e,o){this.alert.type=e,this.alert.message=o,this.showAlert=!0,setTimeout(()=>{this.showAlert=!1},2e3)}getBlockFileList(){this.loading=!0,this.apiService.getBlockIpListData().pipe((0,T.K)(e=>(this.showTimedAlert("error","Error Fetching Data"),this.loading=!1,(0,k.of)({api_status:"error",message:"Failed to fetch data"})))).subscribe(e=>{this.showAlert=!1,"success"===e.api_status?(this.loading=!1,this.blockIps=e.data.map(o=>({ip:o})),this.showTimedAlert("success","Updated Successfully")):(this.showTimedAlert("error",e.message||"Unknown error"),this.loading=!1)})}onEditRow(e){"block-ip-delete"===e.sep&&this.dialog.open(B.d,{width:"700px",disableClose:!0,data:{title:"Delete Block",row:e,message:"Are you sure you want to delete Block IP "+e.ip+"?",action:"block-ip-delete"}}).afterClosed().subscribe(l=>{this.refreshTable(),this.showTimedAlert("success","Updated successfully")})}refreshTable(){this.loading=!0,this.getBlockFileList()}AddBlockIP(){this.dialog.open(J,{width:"500px",disableClose:!1,data:{title:"Add Block IP",row:"",sep:"add"}}).afterClosed().subscribe(o=>{this.refreshTable(),this.showTimedAlert("success","Updated successfully")})}ngOnInit(){}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(f.N),t.Y36(t.sBO),t.Y36(a.uw))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-block-ips"]],decls:16,vars:7,consts:[[1,"flex","flex-auto","p-3","sm:p-5"],[1,"flex","flex-col","flex-auto","w-full"],["class","mb-8",4,"ngIf"],["class","flex justify-center items-center my-4",4,"ngIf"],[1,"grid","grid-cols-1","sm:grid-cols-1","lg:grid-cols-1","mb-4"],[1,"grid","grid-cols-2","sm:grid-cols-2","lg:grid-cols-2","rounded-t-xl","bg-primary-500"],[1,"justify-self-start","flex","items-center"],[1,"text-xl","font-bold","leading-none","tracking-tight","text-white","pl-5"],[1,"justify-self-end","m-2","mr-4"],["matTooltip","Add IP","class","px-2 mr-2 pt-1 bg-white text-white rounded-md",3,"disabled","click",4,"ngIf"],["matTooltip","Refresh","class","px-2 pt-1 bg-white text-white rounded-md",3,"disabled","click",4,"ngIf"],[1,"bg-card","rounded-b-2xl","grid","grid-cols-1","sm:grid-cols-1","lg:grid-cols-1","mb-4","rounded-b-2xl"],[1,"flex","flex-col","px-5","pt-4","pb-2","shadow","overflow-hidden","bg-card"],[3,"data","displayedColumns","headerMapping","editRow"],[1,"mb-8"],["class","mt-0 -mb-2",3,"appearance","showIcon","type",4,"ngIf"],[1,"mt-0","-mb-2",3,"appearance","showIcon","type"],[1,"flex","justify-center","items-center","my-4"],["mode","indeterminate",1,"w-full"],["matTooltip","Add IP",1,"px-2","mr-2","pt-1","bg-white","text-white","rounded-md",3,"disabled","click"],[1,"text-primary"],["matTooltip","Refresh",1,"px-2","pt-1","bg-white","text-white","rounded-md",3,"disabled","click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,N,2,1,"div",2),t.YNc(3,S,2,0,"div",3),t.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7),t._uU(8," Block IPs List "),t.qZA()(),t.TgZ(9,"div",8),t.YNc(10,U,3,1,"button",9),t.YNc(11,Y,3,1,"button",10),t.qZA()(),t.TgZ(12,"div",11)(13,"div")(14,"div",12)(15,"app-dynamic-table",13),t.NdJ("editRow",function(p){return o.onEditRow(p)}),t.qZA()()()()()()()),2&e&&(t.xp6(2),t.Q6J("ngIf",o.showAlert),t.xp6(1),t.Q6J("ngIf",o.loading),t.xp6(7),t.Q6J("ngIf",!o.loading),t.xp6(1),t.Q6J("ngIf",!o.loading),t.xp6(4),t.Q6J("data",o.blockIps)("displayedColumns",o.displayedColumns)("headerMapping",o.headerMapping))},directives:[g.O5,h.W,x.pW,v.gM,r.Hw,P.Q],styles:[""],encapsulation:2}),s})();var R=i(8558),E=i(7775),M=i(797),j=i(9722),D=i(4095),L=i(5804);const O=[{path:"",component:Q}];let H=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[[A.Bz.forChild(O),u.ot,r.Ps,R.rP,E.fC,x.Cv,M.c,v.AV,c.lN,L.J,b.Cq,I.c,a.Is,D.Fk,j.LD,y.m]]}),s})()}}]);