"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[749],{4749:(D,d,s)=>{s.r(d),s.d(d,{MalwareModule:()=>k});var u=s(325),m=s(1377),c=s(1279),h=s(4466),n=s(1086),r=s(7221),t=s(5e3),p=s(8125),f=s(9808),x=s(2494),g=s(1101),v=s(1218);function w(i,o){if(1&i&&(t.TgZ(0,"fuse-alert",30),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.Q6J("appearance","outline")("showIcon",!0)("type",e.alert.type),t.xp6(1),t.hij(" ",e.alert.message," ")}}function b(i,o){if(1&i&&(t.TgZ(0,"div",28),t.YNc(1,w,2,4,"fuse-alert",29),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.showAlert)}}function A(i,o){1&i&&(t.TgZ(0,"div",31),t._UZ(1,"mat-progress-bar",32),t.qZA())}function C(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",33),t.NdJ("click",function(){return t.CHM(e),t.oxw().updateDB()}),t.TgZ(1,"mat-icon",34),t._uU(2,"download"),t.qZA()()}if(2&i){const e=t.oxw();t.Q6J("disabled",e.loading)}}function T(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",35),t.NdJ("click",function(){return t.CHM(e),t.oxw().getMaliciousFileList()}),t.TgZ(1,"mat-icon",36),t._uU(2,"refresh"),t.qZA()()}if(2&i){const e=t.oxw();t.Q6J("disabled",e.loading)}}let Z=(()=>{class i{constructor(e,a){this.apiService=e,this.cdr=a,this.alert={type:"success",message:""},this.showAlert=!1,this.loading=!1,this.storedDefCount=0,this.LastUpdatedDefCount=0,this.activeCount=0,this.inactiveCount=0,this.headerMapping={ip:"IP",status:"Status",malware_action:"Action"},this.displayedColumns=["ip","status","malware_action"],this.blockedIps=[],this.maliciousFileList="list",this.getMaliciousFileList()}showTimedAlert(e,a){this.alert.type=e,this.alert.message=a,this.showAlert=!0,setTimeout(()=>{this.showAlert=!1},2e3)}getMaliciousFileList(){this.loading=!0,this.apiService.getMalwareListData().pipe((0,r.K)(e=>(this.showTimedAlert("error","Error Fetching Data"),this.loading=!1,(0,n.of)({api_status:"error",message:"Failed to fetch data"})))).subscribe(e=>{this.showAlert=!1,"success"===e.api_status?(this.loading=!1,this.blockedIps=e.blockedIps,this.storedDefCount=e.entries,this.activeCount=e.uncommentedCount,this.inactiveCount=e.commentedCount,this.showTimedAlert("success","Updated Successfully")):(this.showTimedAlert("error",e.message||"Unknown error"),this.loading=!1)})}updateDB(){this.loading=!0,this.apiService.UpdateMalwareData().pipe((0,r.K)(e=>(this.showTimedAlert("error","Error Fetching Data"),this.loading=!1,(0,n.of)({api_status:"error",message:"Failed to fetch data"})))).subscribe(e=>{if(this.showAlert=!1,"success"===e.api_status){this.loading=!1;let a=e.output.match(/Entries:\s*(\d+)/);a&&(this.LastUpdatedDefCount=parseInt(a[1],10)-1),this.showTimedAlert("success",e.output)}else this.showTimedAlert("error",e.message||"Unknown error"),this.loading=!1})}onEditRow(e){console.log("Editing Row:",e),"malware-toggle-change"===e.sep&&("active"==e.status?(console.log("Changing status to Inactive",e.ip,e.status),this.updateStatus(e.ip,"inactive")):(console.log("Changing status to Active",e.ip,e.status),this.updateStatus(e.ip,"active")))}updateStatus(e,a){this.loading=!0,this.apiService.updateMalwareIPStatus(e,a).pipe((0,r.K)(l=>(console.error("API error:",l),this.showTimedAlert("error","Error Fetching Data"),this.loading=!1,(0,n.of)({api_status:"error",message:"Failed to fetch data"})))).subscribe(l=>{console.log("API Response:",l),this.showAlert=!1,"success"===l.api_status?(this.loading=!1,this.showTimedAlert("success","Updated Successfully"),this.getMaliciousFileList()):(this.showTimedAlert("error",l.message||"Unknown error"),this.loading=!1)})}ngOnInit(){}toggleChanged(e){console.log("Checked:",e.checked)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(p.N),t.Y36(t.sBO))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-malware"]],decls:45,vars:11,consts:[[1,"flex","flex-auto","p-3","sm:p-5"],[1,"flex","flex-col","flex-auto","w-full"],["class","mb-8",4,"ngIf"],["class","flex justify-center items-center my-4",4,"ngIf"],[1,"grid","grid-cols-1","sm:grid-cols-1","lg:grid-cols-6","gap-4","mb-4"],[1,"bg-card","flex","flex-auto","flex-col","overflow-hidden","rounded-2xl","p-3","shadow"],[1,"flex","flex-col","items-center"],[1,"text-2xl","font-medium","leading-none","tracking-tight","text-blue-500","sm:text-4xl"],[1,"text-lg","text-blue-600","dark:text-blue-500"],[1,"text-2xl","font-medium","leading-none","tracking-tight","text-orange-500","sm:text-4xl"],[1,"text-lg","text-orange-600","dark:text-orange-500"],[1,"text-2xl","font-medium","leading-none","tracking-tight","text-green-500","sm:text-4xl"],[1,"text-lg","text-green-600","dark:text-green-500"],[1,"text-2xl","font-medium","leading-none","tracking-tight","text-red-500","sm:text-4xl"],[1,"text-lg","text-red-600","dark:text-red-500"],[1,"col-span-2","grid","grid-cols-2","bg-card","rounded-2xl","shadow","w-full"],[1,"bg-orange-400","rounded-l-2xl","flex","items-center","justify-center","text-on-primary","text-lg","font-bold","p-2"],[1,"bg-card","rounded-r-2xl","flex","items-center","justify-center","text-xl","p-3"],["class","px-2 pt-1  rounded-md",3,"disabled","click",4,"ngIf"],[1,"grid","grid-cols-1","sm:grid-cols-1","lg:grid-cols-1","mb-4"],[1,"grid","grid-cols-2","sm:grid-cols-2","lg:grid-cols-2","rounded-xl","bg-primary-500"],[1,"justify-self-start","flex","items-center"],[1,"text-xl","font-bold","leading-none","tracking-tight","text-white","pl-5"],[1,"justify-self-end","m-2","mr-4"],["class","px-2 pt-1 bg-white text-white rounded-md",3,"disabled","click",4,"ngIf"],[1,"bg-card","rounded-b-2xl","grid","grid-cols-1","sm:grid-cols-1","lg:grid-cols-1","mb-4","rounded-b-2xl"],[1,"flex","flex-col","px-5","pt-4","pb-2","shadow","rounded-2xl","overflow-hidden","bg-card"],[3,"data","displayedColumns","headerMapping","editRow"],[1,"mb-8"],["class","mt-0 -mb-2",3,"appearance","showIcon","type",4,"ngIf"],[1,"mt-0","-mb-2",3,"appearance","showIcon","type"],[1,"flex","justify-center","items-center","my-4"],["mode","indeterminate",1,"w-full"],[1,"px-2","pt-1","rounded-md",3,"disabled","click"],[1,"text-primary","text-4xl"],[1,"px-2","pt-1","bg-white","text-white","rounded-md",3,"disabled","click"],[1,"text-primary"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,b,2,1,"div",2),t.YNc(3,A,2,0,"div",3),t.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7),t._uU(8),t.qZA(),t.TgZ(9,"div",8),t._uU(10," Last Fetch Malware Entries "),t.qZA()()(),t.TgZ(11,"div",5)(12,"div",6)(13,"div",9),t._uU(14),t.qZA(),t.TgZ(15,"div",10),t._uU(16," Stored Malware Entries "),t.qZA()()(),t.TgZ(17,"div",5)(18,"div",6)(19,"div",11),t._uU(20),t.qZA(),t.TgZ(21,"div",12),t._uU(22," Active Entries "),t.qZA()()(),t.TgZ(23,"div",5)(24,"div",6)(25,"div",13),t._uU(26),t.qZA(),t.TgZ(27,"div",14),t._uU(28," Inactive Entries "),t.qZA()()(),t.TgZ(29,"div",15)(30,"div",16),t._uU(31," Live Update "),t.qZA(),t.TgZ(32,"div",17),t.YNc(33,C,3,1,"button",18),t.qZA()()(),t.TgZ(34,"div",19)(35,"div",20)(36,"div",21)(37,"div",22),t._uU(38," Malware Protection - Malicious Database "),t.qZA()(),t.TgZ(39,"div",23),t.YNc(40,T,3,1,"button",24),t.qZA()(),t.TgZ(41,"div",25)(42,"div")(43,"div",26)(44,"app-dynamic-table",27),t.NdJ("editRow",function(F){return a.onEditRow(F)}),t.qZA()()()()()()()),2&e&&(t.xp6(2),t.Q6J("ngIf",a.showAlert),t.xp6(1),t.Q6J("ngIf",a.loading),t.xp6(5),t.hij(" ",a.LastUpdatedDefCount," "),t.xp6(6),t.hij(" ",a.storedDefCount," "),t.xp6(6),t.hij(" ",a.activeCount," "),t.xp6(6),t.hij(" ",a.inactiveCount," "),t.xp6(7),t.Q6J("ngIf",!a.loading),t.xp6(7),t.Q6J("ngIf",!a.loading),t.xp6(4),t.Q6J("data",a.blockedIps)("displayedColumns",a.displayedColumns)("headerMapping",a.headerMapping))},directives:[f.O5,x.W,g.pW,c.Hw,v.Q],styles:[".custom-toggle .mat-slide-toggle-bar{background-color:#ef4444}.custom-toggle.mat-checked .mat-slide-toggle-bar{background-color:#22c55e!important}.custom-toggle .mat-slide-toggle-thumb{background-color:#fff}.custom-toggle.mat-checked .mat-slide-toggle-thumb{background-color:#22c55e!important}\n"],encapsulation:2}),i})();var M=s(8558),y=s(7775),I=s(797);const U=[{path:"",component:Z}];let k=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[u.Bz.forChild(U),m.ot,c.Ps,M.rP,y.fC,g.Cv,I.c,h.m]]}),i})()}}]);