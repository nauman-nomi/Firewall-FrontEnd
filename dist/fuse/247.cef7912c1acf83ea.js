"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[247],{5247:(X,c,l)=>{l.r(c),l.d(c,{WhitelistIpsModule:()=>B});var A=l(325),h=l(1377),r=l(1279),y=l(4466),w=l(1086),T=l(7221),W=l(9971),d=l(3075),a=l(8341),t=l(5e3),u=l(8125),f=l(9808),g=l(2494),p=l(1223),I=l(6766),x=l(6808);function C(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"fuse-alert",16),t.NdJ("dismissed",function(){return t.CHM(e),t.oxw().showAlert=!1}),t._uU(1),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("type",e.alert.type)("dismissible",!0),t.xp6(1),t.hij(" ",e.alert.message," ")}}function Z(i,n){1&i&&(t.TgZ(0,"small",17),t._uU(1," Invalid IP Address. "),t.qZA())}function J(i,n){1&i&&t._UZ(0,"mat-progress-spinner",18),2&i&&t.Q6J("diameter",24)("mode","indeterminate")}let P=(()=>{class i{constructor(e,s,o,m,_){this.dialogRef=e,this.data=s,this.nicService=o,this.cdr=m,this.fb=_,this.errorAlert={type:"error",message:""},this.alert={type:"error",message:"Error!"},this.showAlert=!1,this.isSubmitting=!1,console.log(this.data.row),this.addWhitelistIPForm=this.fb.group({ip_address:["",[d.kI.required,d.kI.pattern(/^(\d{1,3}\.){3}\d{1,3}((:\d{1,5})|(\/\d{1,2}))?$/)]]})}ngOnInit(){}closeDialog(){this.dialogRef.close("Dialog Closed")}onSubmit(){if(this.addWhitelistIPForm.invalid)return this.showAlert=!0,this.errorAlert.message="Please fill all required fields correctly.",void(this.errorAlert.type="error");this.isSubmitting=!0;const e=this.addWhitelistIPForm.value,s=new FormData;s.append("ip_address",e.ip_address),this.nicService.addWhitelistIP(s).subscribe(o=>{this.isSubmitting=!1,this.showAlert=!0,this.alert.type="success",this.alert.message="IP Added successfully!",this.cdr.detectChanges(),setTimeout(()=>{this.dialogRef.close(s)},2e3)},o=>{this.isSubmitting=!1,this.showAlert=!0,this.alert.type="error",this.alert.message="Failed to add IP address. Please try again.",console.error("Error:",o),this.cdr.detectChanges()})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(a.so),t.Y36(a.WI),t.Y36(u.N),t.Y36(t.sBO),t.Y36(d.qu))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-add-whitelist-ip"]],decls:21,vars:7,consts:[[1,"dialog-content"],[1,"dialog-header","bg-primary","rounded-t-2xl","p-2","px-4","flex","justify-between","items-center"],[1,"text-xl","font-semibold","leading-none","tracking-tight","text-white"],["mat-icon-button","",3,"click"],[1,"text-white"],[3,"type","dismissible","dismissed",4,"ngIf"],[1,"rounded-lg",3,"formGroup","ngSubmit"],[1,"dialog-body"],[1,"flex","justify-center","px-3"],["appearance","standard",1,"w-full"],[1,"block","font-semibold","mb-1"],["matInput","","type","text","formControlName","ip_address","placeholder","x.x.x.x"],["class","error",4,"ngIf"],["align","end",1,"mt-2"],["type","submit","mat-flat-button","",1,"fuse-mat-button-medium","w-28",3,"color","disabled"],["class","ml-3",3,"diameter","mode",4,"ngIf"],[3,"type","dismissible","dismissed"],[1,"error"],[1,"ml-3",3,"diameter","mode"]],template:function(e,s){if(1&e&&(t.TgZ(0,"mat-dialog-content",0)(1,"div",1)(2,"div",2),t._uU(3),t.qZA(),t.TgZ(4,"button",3),t.NdJ("click",function(){return s.closeDialog()}),t.TgZ(5,"mat-icon",4),t._uU(6,"close"),t.qZA()()(),t.YNc(7,C,2,3,"fuse-alert",5),t.TgZ(8,"form",6),t.NdJ("ngSubmit",function(){return s.onSubmit()}),t.TgZ(9,"div",7)(10,"div",8)(11,"mat-form-field",9)(12,"mat-label",10),t._uU(13,"Enter IP Address"),t.qZA(),t._UZ(14,"input",11),t.YNc(15,Z,2,0,"small",12),t.qZA()()(),t.TgZ(16,"div",13)(17,"button",14)(18,"span"),t._uU(19," Submit "),t.qZA(),t.YNc(20,J,1,2,"mat-progress-spinner",15),t.qZA()()()()),2&e){let o;t.xp6(3),t.hij(" ",s.data.title," "),t.xp6(4),t.Q6J("ngIf",s.showAlert),t.xp6(1),t.Q6J("formGroup",s.addWhitelistIPForm),t.xp6(7),t.Q6J("ngIf",(null==(o=s.addWhitelistIPForm.get("ip_address"))?null:o.invalid)&&(null==(o=s.addWhitelistIPForm.get("ip_address"))?null:o.touched)),t.xp6(2),t.Q6J("color","primary")("disabled",s.addWhitelistIPForm.invalid||s.addWhitelistIPForm.hasError("nonUniqueSelection")),t.xp6(3),t.Q6J("ngIf",s.isSubmitting)}},directives:[a.xY,h.lW,r.Hw,f.O5,g.W,d._Y,d.JL,d.sg,p.KE,p.hX,I.Nt,d.Fj,d.JJ,d.u,x.Ou],styles:[""]}),i})();var b=l(1101),v=l(9824),F=l(1218);function N(i,n){if(1&i&&(t.TgZ(0,"fuse-alert",16),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.Q6J("appearance","outline")("showIcon",!0)("type",e.alert.type),t.xp6(1),t.hij(" ",e.alert.message," ")}}function S(i,n){if(1&i&&(t.TgZ(0,"div",14),t.YNc(1,N,2,4,"fuse-alert",15),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.showAlert)}}function U(i,n){1&i&&(t.TgZ(0,"div",17),t._UZ(1,"mat-progress-bar",18),t.qZA())}function Y(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"button",19),t.NdJ("click",function(){return t.CHM(e),t.oxw().AddWhitelistIP()}),t.TgZ(1,"mat-icon",20),t._uU(2,"add"),t.qZA()()}if(2&i){const e=t.oxw();t.Q6J("disabled",e.loadingip)}}function Q(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"button",21),t.NdJ("click",function(){return t.CHM(e),t.oxw().refreshTable()}),t.TgZ(1,"mat-icon",20),t._uU(2,"refresh"),t.qZA()()}if(2&i){const e=t.oxw();t.Q6J("disabled",e.loadingip)}}let R=(()=>{class i{constructor(e,s,o){this.apiService=e,this.cdr=s,this.dialog=o,this.alert={type:"success",message:""},this.showAlert=!1,this.loadingip=!1,this.headerMapping={ip:"IP",whitelist_status:"Status",whitelist_action:"Action"},this.displayedColumns=["ip","whitelist_status","whitelist_action"],this.whitelistIps=[],this.getWhitelistFileList()}showTimedAlert(e,s){this.alert.type=e,this.alert.message=s,this.showAlert=!0,setTimeout(()=>{this.showAlert=!1},2e3)}getWhitelistFileList(){this.loadingip=!0,this.apiService.getWhitelistIpListData().pipe((0,T.K)(e=>(this.showTimedAlert("error","Error Fetching Data"),this.loadingip=!1,(0,w.of)({api_status:"error",message:"Failed to fetch data"})))).subscribe(e=>{this.showAlert=!1,"success"===e.api_status?(this.loadingip=!1,console.log(e.data),this.whitelistIps=e.data.map(s=>({ip:s})),this.showTimedAlert("success","Updated Successfully")):(this.showTimedAlert("error",e.message||"Unknown error"),this.loadingip=!1)})}onEditRow(e){"whitelist-ip-delete"===e.sep&&this.dialog.open(W.d,{width:"700px",disableClose:!0,data:{title:"Delete Whitelist",row:e,message:"Are you sure you want to delete Whitelist IP "+e.ip+"?",action:"whitelist-ip-delete"}}).afterClosed().subscribe(o=>{this.refreshTable(),this.showTimedAlert("success","Updated successfully")})}refreshTable(){this.loadingip=!0,this.getWhitelistFileList()}AddWhitelistIP(){this.dialog.open(P,{width:"500px",disableClose:!1,data:{title:"Add Whitelist IP",row:"",sep:"add"}}).afterClosed().subscribe(s=>{this.refreshTable(),this.showTimedAlert("success","Updated successfully")})}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(u.N),t.Y36(t.sBO),t.Y36(a.uw))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-whitelist-ips"]],decls:16,vars:7,consts:[[1,"flex","flex-auto","p-3","sm:p-5"],[1,"flex","flex-col","flex-auto","w-full"],["class","mb-8",4,"ngIf"],["class","flex justify-center items-center my-4",4,"ngIf"],[1,"grid","grid-cols-1","sm:grid-cols-1","lg:grid-cols-1","mb-4"],[1,"grid","grid-cols-2","sm:grid-cols-2","lg:grid-cols-2","rounded-t-xl","bg-primary-500"],[1,"justify-self-start","flex","items-center"],[1,"text-xl","font-bold","leading-none","tracking-tight","text-white","pl-5"],[1,"justify-self-end","m-2","mr-4"],["matTooltip","Add IP","class","px-2 mr-2 pt-1 bg-white text-white rounded-md",3,"disabled","click",4,"ngIf"],["matTooltip","Refresh","class","px-2 pt-1 bg-white text-white rounded-md",3,"disabled","click",4,"ngIf"],[1,"bg-card","rounded-b-2xl","grid","grid-cols-1","sm:grid-cols-1","lg:grid-cols-1","mb-4","rounded-b-2xl"],[1,"flex","flex-col","px-5","pt-4","pb-2","shadow","overflow-hidden","bg-card"],[3,"data","displayedColumns","headerMapping","editRow"],[1,"mb-8"],["class","mt-0 -mb-2",3,"appearance","showIcon","type",4,"ngIf"],[1,"mt-0","-mb-2",3,"appearance","showIcon","type"],[1,"flex","justify-center","items-center","my-4"],["mode","indeterminate",1,"w-full"],["matTooltip","Add IP",1,"px-2","mr-2","pt-1","bg-white","text-white","rounded-md",3,"disabled","click"],[1,"text-primary"],["matTooltip","Refresh",1,"px-2","pt-1","bg-white","text-white","rounded-md",3,"disabled","click"]],template:function(e,s){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,S,2,1,"div",2),t.YNc(3,U,2,0,"div",3),t.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7),t._uU(8," Whitelist IP Database "),t.qZA()(),t.TgZ(9,"div",8),t.YNc(10,Y,3,1,"button",9),t.YNc(11,Q,3,1,"button",10),t.qZA()(),t.TgZ(12,"div",11)(13,"div")(14,"div",12)(15,"app-dynamic-table",13),t.NdJ("editRow",function(m){return s.onEditRow(m)}),t.qZA()()()()()()()),2&e&&(t.xp6(2),t.Q6J("ngIf",s.showAlert),t.xp6(1),t.Q6J("ngIf",s.loadingip),t.xp6(7),t.Q6J("ngIf",!s.loadingip),t.xp6(1),t.Q6J("ngIf",!s.loadingip),t.xp6(4),t.Q6J("data",s.whitelistIps)("displayedColumns",s.displayedColumns)("headerMapping",s.headerMapping))},directives:[f.O5,g.W,b.pW,v.gM,r.Hw,F.Q],styles:[""],encapsulation:2}),i})();var E=l(8558),M=l(7775),j=l(797),D=l(9722),O=l(4095),L=l(5804);const H=[{path:"",component:R}];let B=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[A.Bz.forChild(H),h.ot,r.Ps,E.rP,M.fC,b.Cv,j.c,v.AV,p.lN,L.J,x.Cq,I.c,a.Is,O.Fk,D.LD,y.m]]}),i})()}}]);